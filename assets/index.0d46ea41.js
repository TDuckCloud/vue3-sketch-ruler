var ne=Object.defineProperty;var _=Object.getOwnPropertySymbols;var oe=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var z=(e,t,n)=>t in e?ne(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,F=(e,t)=>{for(var n in t||(t={}))oe.call(t,n)&&z(e,n,t[n]);if(_)for(var n of _(t))le.call(t,n)&&z(e,n,t[n]);return e};import{d as B,r as b,o as A,c as C,w as H,v as W,a as N,b as R,t as j,n as O,e as $,f as K,g as q,h as P,i as D,F as G,j as ae,k as U,l as re,m as Q,p as se,u as ie,q as ce}from"./vendor.016c5317.js";const de=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}};de();const he={scale:Number,thick:Number,palette:Object,index:Number,start:Number,vertical:Boolean,value:Number,isShowReferLine:Boolean};var I=(e,t)=>{for(const[n,s]of t)e[n]=s;return e};const ue=B({name:"LineRuler",props:he,emits:["onMouseDown","onRelease","onRemove"],setup(e,{emit:t}){const n=b(0),s=b(!0);A(()=>{n.value=e.value});const o=d=>{s.value=d>=0},a=C(()=>{const d=(n.value-e.start)*e.scale;o(d);const r=d+"px";return e.vertical?{top:r}:{left:r}}),l=C(()=>{var h;const d=`1px solid ${(h=e.palette)==null?void 0:h.lineColor}`,r=e.vertical?{borderTop:d}:{borderLeft:d},c=e.isShowReferLine?e.vertical?"ns-resize":"ew-resize":"none";return F({cursor:c},r)}),f=C(()=>e.vertical?{left:e.thick+"px"}:{top:e.thick+"px"});return{startValue:n,showLine:s,offset:a,borderCursor:l,actionStyle:f,handleDown:d=>{const r=e.vertical?d.clientY:d.clientX,c=n.value;t("onMouseDown");const h=p=>{const i=e.vertical?p.clientY:p.clientX,w=Math.round(c+(i-r)/e.scale);n.value=w},u=()=>{t("onRelease",n.value,e.index),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",u)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",u)},handleRemove:()=>{t("onRemove",e.index)}}}}),fe={class:"value"};function ve(e,t,n,s,o,a){return H(($(),N("div",{class:"line",style:O([e.offset,e.borderCursor]),onMousedown:t[1]||(t[1]=(...l)=>e.handleDown&&e.handleDown(...l))},[R("div",{class:"action",style:O(e.actionStyle)},[R("span",{class:"del",onClick:t[0]||(t[0]=(...l)=>e.handleRemove&&e.handleRemove(...l))},"\xD7"),R("span",fe,j(e.startValue),1)],4)],36)),[[W,e.showLine]])}var ge=I(ue,[["render",ve],["__scopeId","data-v-ddd28c10"]]);const Z=e=>e<=.25?40:e<=.5?20:e<=1?10:e<=2?5:e<=4?2:1,T=.83,we=(e,t,n,s)=>{const{scale:o,width:a,height:l,palette:f}=s,{bgColor:g,fontColor:L,shadowColor:d,ratio:r,longfgColor:c,shortfgColor:h}=f;if(e.scale(r,r),e.clearRect(0,0,a,l),e.fillStyle=g,e.fillRect(0,0,a,l),n){const v=(n.x-t)*o,m=n.width*o;e.fillStyle=d,e.fillRect(v,0,m,l*3/8)}const u=Z(o),p=u*o,i=u*10,w=i*o,S=Math.floor(t/u)*u,k=Math.floor(t/i)*i,E=(S-t)/u*p,Y=(k-t)/i*w,M=t+Math.ceil(a/o);e.beginPath(),e.fillStyle=L,e.strokeStyle=c;for(let v=k,m=0;v<M;v+=i,m++){const y=Y+m*w+.5;e.moveTo(y,0),e.save(),e.translate(y,l*.4),e.scale(T/r,T/r),e.fillText(v.toString(),4*r,7*r),e.restore(),e.lineTo(y,l*9/16)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=h;for(let v=S,m=0;v<M;v+=u,m++){const y=E+m*p+.5;e.moveTo(y,0),v%i!=0&&e.lineTo(y,l*1/4)}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},me=(e,t,n,s)=>{const{scale:o,width:a,height:l,palette:f}=s,{bgColor:g,fontColor:L,shadowColor:d,ratio:r,longfgColor:c,shortfgColor:h}=f;if(e.scale(r,r),e.clearRect(0,0,a,l),e.fillStyle=g,e.fillRect(0,0,a,l),n){const v=(n.y-t)*o,m=n.height*o;e.fillStyle=d,e.fillRect(0,v,a*3/8,m)}const u=Z(o),p=u*o,i=u*10,w=i*o,S=Math.floor(t/u)*u,k=Math.floor(t/i)*i,E=(S-t)/u*p,Y=(k-t)/i*w,M=t+Math.ceil(l/o);e.beginPath(),e.fillStyle=L,e.strokeStyle=c;for(let v=k,m=0;v<M;v+=i,m++){const y=Y+m*w+.5;e.moveTo(0,y),e.save(),e.translate(a*.4,y),e.rotate(-Math.PI/2),e.scale(T/r,T/r),e.fillText(v.toString(),4*r,7*r),e.restore(),e.lineTo(a*9/16,y)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=h;for(let v=S,m=0;v<M;v+=u,m++){const y=E+m*p+.5;e.moveTo(0,y),v%i!=0&&e.lineTo(a*1/4,y)}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},Ce={scale:Number,ratio:Number,palette:Object,vertical:Boolean,start:Number,width:Number,height:Number,selectStart:Number,selectLength:Number},ye=B({name:"CanvasRuler",props:Ce,emits:["onAddLine","onIndicatorShow","onIndicatorMove","onIndicatorHide"],setup(e,{emit:t}){const n=K({canvasContext:null}),s=b(null);A(()=>{o(),a(),l()});const o=()=>{n.canvasContext=s.value&&s.value.getContext("2d")},a=()=>{if(s.value){const c=e.ratio;console.log(c),s.value.width=e.width*c,s.value.height=e.height*c;const h=n.canvasContext;h&&(h.font=`${12*c}px -apple-system,
                "Helvetica Neue", ".SFNSText-Regular",
                "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB",
                "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif`,h.lineWidth=1,h.textBaseline="middle")}},l=()=>{const c={scale:e.scale,width:e.width,height:e.height,palette:e.palette};e.vertical&&n.canvasContext?me(n.canvasContext,e.start,{y:e.selectStart,height:e.selectLength},c):n.canvasContext&&we(n.canvasContext,e.start,{x:e.selectStart,width:e.selectLength},c)};q(()=>e.start,()=>l()),q([()=>e.width,()=>e.height],()=>{a(),l()});const f=(c,h,u)=>Math.round(h+c/u);return{state:n,canvas:s,initCanvasRef:o,handleClick:c=>{const h=e.vertical?c.offsetY:c.offsetX,u=f(h,e.start,e.scale);t("onAddLine",u)},handleEnter:c=>{const h=e.vertical?c.offsetY:c.offsetX,u=f(h,e.start,e.scale);t("onIndicatorShow",u)},handleMove:c=>{const h=e.vertical?c.offsetY:c.offsetX,u=f(h,e.start,e.scale);t("onIndicatorMove",u)},handleLeave:()=>{t("onIndicatorHide")}}}});function Le(e,t,n,s,o,a){return $(),N("canvas",{ref:"canvas",class:"ruler",onClick:t[0]||(t[0]=(...l)=>e.handleClick&&e.handleClick(...l)),onMouseenter:t[1]||(t[1]=(...l)=>e.handleEnter&&e.handleEnter(...l)),onMousemove:t[2]||(t[2]=(...l)=>e.handleMove&&e.handleMove(...l)),onMouseleave:t[3]||(t[3]=(...l)=>e.handleLeave&&e.handleLeave(...l))},null,544)}var pe=I(ye,[["render",Le]]);const Se={scale:Number,ratio:Number,thick:Number,palette:Object,vertical:{type:Boolean,default:!0},width:{type:Number,default:200},height:{type:Number,default:200},start:{type:Number,default:0},lines:{type:Array,default:()=>[100,200]},selectStart:{type:Number},selectLength:{type:Number},isShowReferLine:{type:Boolean}};const be=B({name:"RulerWrapper",components:{CanvasRuler:pe,RulerLine:ge},props:Se,emits:["onLineChange"],setup(e,{emit:t}){const n=b(!1),s=b(!1),o=b(0),a=C(()=>e.vertical?"v-container":"h-container"),l=C(()=>{const i={width:`calc(100% - ${e.thick}px)`,height:`${e.thick+1}px`,left:`${e.thick}px`},w={width:`${e.thick&&e.thick+1}px`,height:`calc(100% - ${e.thick}px)`,top:`${e.thick}px`};return e.vertical?w:i}),f=C(()=>{var i;return{borderTop:`1px solid ${(i=e.palette)==null?void 0:i.lineColor}`,cursor:e.isShowReferLine?"ns-resize":"none"}}),g=C(()=>{var k;const i=(o.value-e.start)*e.scale;let w="top",S="borderLeft";return w=e.vertical?"top":"left",S=e.vertical?"borderBottom":"borderLeft",{[w]:i+"px",[S]:`1px solid ${(k=e.palette)==null?void 0:k.lineColor}`}}),L=i=>{e.lines.push(i),t("onLineChange",e.lines,e.vertical)},d=i=>{n.value||(s.value=!0,o.value=i)},r=i=>{s.value&&(o.value=i)},c=()=>{s.value=!1},h=()=>{n.value=!0},u=(i,w)=>{n.value=!1;const S=i-e.start,k=(e.vertical?e.height:e.width)/e.scale;S<0||S>k?p(w):(e.lines[w]=i,t("onLineChange",e.lines,e.vertical))},p=i=>{e.lines.splice(i,1),t("onLineChange",e.lines,e.vertical)};return{isDraggingLine:n,showIndicator:s,valueNum:o,rwClassName:a,rwStyle:l,lineStyle:f,indicatorStyle:g,handleNewLine:L,handleLineDown:h,handleLineRelease:u,handleIndicatorMove:r,handleIndicatorShow:d,handleIndicatorHide:c,handleLineRemove:p}}}),Re={class:"lines"},ke={class:"value"};function $e(e,t,n,s,o,a){const l=P("CanvasRuler"),f=P("RulerLine");return $(),N("div",{class:U(e.rwClassName),style:O(e.rwStyle)},[D(l,{vertical:e.vertical,scale:e.scale,width:e.width,height:e.height,start:e.start,ratio:e.ratio,"select-start":e.selectStart,"select-length":e.selectLength,palette:e.palette,onOnAddLine:e.handleNewLine,onOnIndicatorShow:e.handleIndicatorShow,onOnIndicatorMove:e.handleIndicatorMove,onOnIndicatorHide:e.handleIndicatorHide},null,8,["vertical","scale","width","height","start","ratio","select-start","select-length","palette","onOnAddLine","onOnIndicatorShow","onOnIndicatorMove","onOnIndicatorHide"]),H(R("div",Re,[($(!0),N(G,null,ae(e.lines,(g,L)=>($(),re(f,{key:g+L,index:L,value:g>>0,scale:e.scale,start:e.start,thick:e.thick,palette:e.palette,vertical:e.vertical,"is-show-refer-line":e.isShowReferLine,onOnRemove:e.handleLineRemove,onOnMouseDown:e.handleLineDown,onOnRelease:e.handleLineRelease},null,8,["index","value","scale","start","thick","palette","vertical","is-show-refer-line","onOnRemove","onOnMouseDown","onOnRelease"]))),128))],512),[[W,e.isShowReferLine]]),H(R("div",{class:"indicator",style:O(e.indicatorStyle)},[R("div",ke,j(e.valueNum),1)],4),[[W,e.showIndicator]])],6)}var Ne=I(be,[["render",$e],["__scopeId","data-v-1e2d9ce8"]]);const Oe={scale:{type:Number,default:1},ratio:{type:Number,default:1},thick:{type:Number,default:16},palette:Object,startX:{type:Number},startY:{type:Number,default:0},shadow:Object,horLineArr:{type:Array,default:()=>[100,200]},verLineArr:{type:Array,default:()=>[100,200]},cornerActive:{type:Boolean,default:!1},isShowReferLine:{type:Boolean,default:!0}};const Me=B({name:"SketchRule",components:{RulerWrapper:Ne},props:Oe,emits:["onCornerClick","handleLine"],setup(e,{emit:t}){const n=C(()=>Q({x:0,y:0,width:200,height:200},e.shadow||{})),s=C(()=>Q({bgColor:"rgba(225,225,225, 0)",longfgColor:"#BABBBC",shortfgColor:"#C8CDD0",fontColor:"#7D8694",shadowColor:"#E8E8E8",lineColor:"#EB5648",borderColor:"#DADADC",cornerActiveColor:"rgb(235, 86, 72, 0.6)",menu:{bgColor:"#fff",dividerColor:"#DBDBDB",listItem:{textColor:"#415058",hoverTextColor:"#298DF8",disabledTextColor:"rgba(65, 80, 88, 0.4)",bgColor:"#fff",hoverBgColor:"#F2F2F2"}}},e.palette||{})),o=C(()=>e.cornerActive?" active":""),a=b(null);let l=b(0),f=b(0);A(()=>{if(console.log(a.value,"55555"),a.value){const r=a.value.getBoundingClientRect();console.log(r,"666666"),l.value=r.width-21,f.value=r.height-21}});const g=C(()=>({backgroundColor:s.value.bgColor,width:e.thick+"px",height:e.thick+"px",borderRight:`1px solid ${s.value.borderColor}`,borderBottom:`1px solid ${s.value.borderColor}`}));return{width:l,height:f,ruler:a,paletteCpu:s,shadowCpu:n,cornerActiveClass:o,cornerStyle:g,onCornerClick:r=>{t("onCornerClick",r)},handleLineChange:(r,c)=>{const h=c?{h:e.horLineArr,v:[...r]}:{h:[...r],v:e.verLineArr};t("handleLine",h)}}}}),Be={ref:"ruler",class:"style-ruler"};function De(e,t,n,s,o,a){const l=P("RulerWrapper");return $(),N("div",Be,[D(l,{vertical:!1,width:e.width,height:e.thick,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startX,lines:e.horLineArr,"select-start":e.shadowCpu.x,"select-length":e.shadowCpu.width,scale:e.scale,palette:e.paletteCpu,onOnLineChange:e.handleLineChange},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette","onOnLineChange"]),D(l,{vertical:!0,width:e.thick,height:e.height,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startY,lines:e.verLineArr,"select-start":e.shadowCpu.y,"select-length":e.shadowCpu.height,scale:e.scale,palette:e.paletteCpu,onOnLineChange:e.handleLineChange},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette","onOnLineChange"]),R("a",{class:U(["corner",e.cornerActiveClass]),style:O(e.cornerStyle),onClick:t[0]||(t[0]=(...f)=>e.onCornerClick&&e.onCornerClick(...f))},null,6)],512)}var V=I(Me,[["render",De]]);V.install=e=>{e.component(V.name,V)};const J=200,x=200,X=B({components:{SketchRule:V},data(){return{height:"500px",font:{size:"2em"}}},setup(){const e=b(null),t=b(null),n=K({scale:1,startX:0,wrapperwith:1200,wrapperheight:500,width:1200,startY:0,lines:{h:[0,200],v:[0,200]},thick:20,isShowRuler:!0,isShowReferLine:!0}),s=C(()=>n.wrapperwith+22+"px"),o=C(()=>n.wrapperheight+22+"px"),a=C(()=>({x:0,y:0,width:J,height:x})),l=C(()=>({width:J,height:x,transform:`scale(${n.scale})`}));A(()=>{window.addEventListener("resize",()=>{n.wrapperwith=window.innerWidth-400,n.wrapperheight=window.innerHeight-400}),e.value.scrollLeft=t.value.getBoundingClientRect().width/2-300});const f=d=>{n.lines=d},g=()=>{const d=document.querySelector("#screens").getBoundingClientRect(),r=document.querySelector("#canvas").getBoundingClientRect(),c=(d.left+n.thick-r.left)/n.scale,h=(d.top+n.thick-r.top)/n.scale;n.startX=c,n.startY=h};return{wrapperwithpx:s,wrapperheightpx:o,screensRef:e,containerRef:t,state:n,shadow:a,canvasStyle:l,handleWheel:d=>{if(d.ctrlKey||d.metaKey){d.preventDefault();const r=parseFloat(Math.max(.2,n.scale-d.deltaY/500).toFixed(2));n.scale=r}se(()=>{g()})},handleScroll:g,handleLine:f}}}),ee=()=>{ie(e=>({"4be16579":e.wrapperwithpx,"47075a4c":e.wrapperheightpx}))},te=X.setup;X.setup=te?(e,t)=>(ee(),te(e,t)):ee;const Ie=X,Ae={class:"wrapper"},Pe={ref:"containerRef",class:"screen-container"};function Te(e,t,n,s,o,a){const l=P("SketchRule");return $(),N("div",Ae,[D(l,{thick:e.state.thick,scale:e.state.scale,"start-x":e.state.startX,"start-y":e.state.startY,shadow:e.shadow,"hor-line-arr":e.state.lines.h,"ver-line-arr":e.state.lines.v,"corner-active":!0,onHandleLine:e.handleLine},null,8,["thick","scale","start-x","start-y","shadow","hor-line-arr","ver-line-arr","onHandleLine"]),R("div",{id:"screens",ref:"screensRef",onWheel:t[0]||(t[0]=(...f)=>e.handleWheel&&e.handleWheel(...f)),onScroll:t[1]||(t[1]=(...f)=>e.handleScroll&&e.handleScroll(...f))},[R("div",Pe,[R("div",{id:"canvas",style:O(e.canvasStyle)},null,4)],512)],544)])}var Ve=I(Ie,[["render",Te],["__scopeId","data-v-dc22af5c"]]);const Ee=R("span",null,"2021/10/21",-1),Ye={setup(e){return(t,n)=>($(),N(G,null,[Ee,D(Ve)],64))}},He=ce(Ye);He.mount("#app");
