var e=Object.defineProperty,t=Object.getOwnPropertySymbols,n=Object.prototype.hasOwnProperty,i=Object.prototype.propertyIsEnumerable,s=(t,n,i)=>n in t?e(t,n,{enumerable:!0,configurable:!0,writable:!0,value:i}):t[n]=i;"undefined"!=typeof require&&require;import{p as o,a as r,w as a,v as l,o as h,c,b as d,t as u,n as f,r as v,d as g,F as C,e as p,f as m,g as w,h as b}from"./vendor.ec734dea.js";!function(){const e=document.createElement("link").relList;if(!(e&&e.supports&&e.supports("modulepreload"))){for(const e of document.querySelectorAll('link[rel="modulepreload"]'))t(e);new MutationObserver((e=>{for(const n of e)if("childList"===n.type)for(const e of n.addedNodes)"LINK"===e.tagName&&"modulepreload"===e.rel&&t(e)})).observe(document,{childList:!0,subtree:!0})}function t(e){if(e.ep)return;e.ep=!0;const t=function(e){const t={};return e.integrity&&(t.integrity=e.integrity),e.referrerpolicy&&(t.referrerPolicy=e.referrerpolicy),"use-credentials"===e.crossorigin?t.credentials="include":"anonymous"===e.crossorigin?t.credentials="omit":t.credentials="same-origin",t}(e);fetch(e.href,t)}}();const L={name:"LineRuler",props:{index:Number,start:Number,vertical:Boolean,scale:Number,value:Number,palette:Object,isShowReferLine:Boolean,thick:Number},emits:["onMouseDown","onRelease","onRemove"],data:()=>({startValue:0,showLine:!0}),computed:{offset(){const e=(this.startValue-this.start)*this.scale;this.setShowLine(e);const t=e+"px";return this.vertical?{top:t}:{left:t}},borderCursor(){const e=`1px solid ${this.palette.lineColor}`,o=this.vertical?{borderTop:e}:{borderLeft:e};return((e,o)=>{for(var r in o||(o={}))n.call(o,r)&&s(e,r,o[r]);if(t)for(var r of t(o))i.call(o,r)&&s(e,r,o[r]);return e})({cursor:this.isShowReferLine?this.vertical?"ns-resize":"ew-resize":"none"},o)},actionStyle(){return this.vertical?{left:this.thick+"px"}:{top:this.thick+"px"}}},mounted(){this.initStartValue()},methods:{setShowLine(e){this.showLine=e>=0},handleDown(e){const t=this.vertical?e.clientY:e.clientX,n=this.startValue;this.$emit("onMouseDown");const i=e=>{const i=this.vertical?e.clientY:e.clientX,s=Math.round(n+(i-t)/this.scale);this.startValue=s},s=()=>{this.$emit("onRelease",this.startValue,this.index),document.removeEventListener("mousemove",i),document.removeEventListener("mouseup",s)};document.addEventListener("mousemove",i),document.addEventListener("mouseup",s)},handleRemove(){this.$emit("onRemove",this.index)},initStartValue(){this.startValue=this.value}}};o("data-v-6271fa82");const y={class:"value"};r(),L.render=function(e,t,n,i,s,o){return a((h(),c("div",{class:"line",style:f([o.offset,o.borderCursor]),onMousedown:t[1]||(t[1]=(...e)=>o.handleDown&&o.handleDown(...e))},[d("div",{class:"action",style:f(o.actionStyle)},[d("span",{class:"del",onClick:t[0]||(t[0]=(...e)=>o.handleRemove&&o.handleRemove(...e))},"Ã—"),d("span",y,u(s.startValue),1)],4)],36)),[[l,s.showLine]])},L.__scopeId="data-v-6271fa82";const S=e=>e<=.25?40:e<=.5?20:e<=1?10:e<=2?5:e<=4?2:1,R=(e,t,n)=>Math.round(t+e/n),k={name:"CanvasRuler",props:{vertical:Boolean,start:Number,scale:Number,width:Number,height:Number,canvasConfigs:Object,selectStart:Number,selectLength:Number},emits:["onAddLine","onIndicatorShow","onIndicatorMove","onIndicatorHide"],data:()=>({$canvas:{},canvasContext:{}}),watch:{start(){this.drawRuler()},width(e){this.updateCanvasContext(),this.drawRuler()},height(e){this.updateCanvasContext(),this.drawRuler()}},mounted(){this.initCanvasRef(),this.updateCanvasContext(),this.drawRuler()},methods:{initCanvasRef(){this.$canvas=this.$refs.$canvas,this.canvasContext=this.$canvas&&this.$canvas.getContext("2d")},updateCanvasContext(){const{ratio:e}=this.canvasConfigs;this.$canvas.width=this.width*e,this.$canvas.height=this.height*e;const t=this.$canvas.getContext("2d");t.font=12*e+'px -apple-system,\n                "Helvetica Neue", ".SFNSText-Regular",\n                "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB",\n                "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif',t.lineWidth=1,t.textBaseline="middle"},drawRuler(){const e={scale:this.scale,width:this.width,height:this.height,canvasConfigs:this.canvasConfigs};this.vertical?((e,t,n,i)=>{const{scale:s,width:o,height:r,canvasConfigs:a}=i,{bgColor:l,fontColor:h,shadowColor:c,ratio:d,longfgColor:u,shortfgColor:f}=a;if(e.scale(d,d),e.clearRect(0,0,o,r),e.fillStyle=l,e.fillRect(0,0,o,r),n){const i=(n.y-t)*s,r=n.height*s;e.fillStyle=c,e.fillRect(0,i,3*o/8,r)}const v=S(s),g=v*s,C=10*v,p=C*s,m=Math.floor(t/v)*v,w=Math.floor(t/C)*C,b=(m-t)/v*g,L=(w-t)/C*p,y=t+Math.ceil(r/s);e.beginPath(),e.fillStyle=h,e.strokeStyle=u;for(let S=w,R=0;S<y;S+=C,R++){const t=L+R*p+.5;e.moveTo(0,t),e.save(),e.translate(.4*o,t),e.rotate(-Math.PI/2),e.scale(.83/d,.83/d),e.fillText(S,4*d,7*d),e.restore(),e.lineTo(9*o/16,t)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=f;for(let S=m,R=0;S<y;S+=v,R++){const t=b+R*g+.5;e.moveTo(0,t),S%C!=0&&e.lineTo(1*o/4,t)}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)})(this.canvasContext,this.start,{y:this.selectStart,height:this.selectLength},e):((e,t,n,i)=>{const{scale:s,width:o,height:r,canvasConfigs:a}=i,{bgColor:l,fontColor:h,shadowColor:c,ratio:d,longfgColor:u,shortfgColor:f}=a;if(e.scale(d,d),e.clearRect(0,0,o,r),e.fillStyle=l,e.fillRect(0,0,o,r),n){const i=(n.x-t)*s,o=n.width*s;e.fillStyle=c,e.fillRect(i,0,o,3*r/8)}const v=S(s),g=v*s,C=10*v,p=C*s,m=Math.floor(t/v)*v,w=Math.floor(t/C)*C,b=(m-t)/v*g,L=(w-t)/C*p,y=t+Math.ceil(o/s);e.beginPath(),e.fillStyle=h,e.strokeStyle=u;for(let S=w,R=0;S<y;S+=C,R++){const t=L+R*p+.5;e.moveTo(t,0),e.save(),e.translate(t,.4*r),e.scale(.83/d,.83/d),e.fillText(S,4*d,7*d),e.restore(),e.lineTo(t,9*r/16)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=f;for(let S=m,R=0;S<y;S+=v,R++){const t=b+R*g+.5;e.moveTo(t,0),S%C!=0&&e.lineTo(t,1*r/4)}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)})(this.canvasContext,this.start,{x:this.selectStart,width:this.selectLength},e)},handleClick(e){const t=this.vertical?e.offsetY:e.offsetX,n=R(t,this.start,this.scale);this.$emit("onAddLine",n)},handleEnter(e){const t=this.vertical?e.offsetY:e.offsetX,n=R(t,this.start,this.scale);this.$emit("onIndicatorShow",n)},handleMove(e){const t=this.vertical?e.offsetY:e.offsetX,n=R(t,this.start,this.scale);this.$emit("onIndicatorMove",n)},handleLeave(){this.$emit("onIndicatorHide")}}};k.render=function(e,t,n,i,s,o){return h(),c("canvas",{ref:"$canvas",class:"ruler",onClick:t[0]||(t[0]=(...e)=>o.handleClick&&o.handleClick(...e)),onMouseenter:t[1]||(t[1]=(...e)=>o.handleEnter&&o.handleEnter(...e)),onMousemove:t[2]||(t[2]=(...e)=>o.handleMove&&o.handleMove(...e)),onMouseleave:t[3]||(t[3]=(...e)=>o.handleLeave&&o.handleLeave(...e))},null,544)};const x={name:"RulerWrapper",components:{CanvasRuler:k,LineRuler:L},props:{vertical:Boolean,scale:Number,width:Number,thick:Number,height:Number,start:Number,lines:Array,selectStart:Number,selectLength:Number,canvasConfigs:Object,palette:Object,isShowReferLine:Boolean,onShowRightMenu:Function,handleShowReferLine:Function},emits:["onLineChange"],data:()=>({isDraggingLine:!1,showIndicator:!1,value:0}),computed:{rwClassName(){return this.vertical?"v-container":"h-container"},rwStyle(){const e={width:`calc(100% - ${this.thick}px)`,height:`${this.thick+1}px`,left:`${this.thick}px`},t={width:`${this.thick+1}px`,height:`calc(100% - ${this.thick}px)`,top:`${this.thick}px`};return this.vertical?t:e},lineStyle(){return{borderTop:`1px solid ${this.palette.lineColor}`,cursor:this.isShowReferLine?"ns-resize":"none"}},indicatorStyle(){const e=(this.value-this.start)*this.scale;let t="top",n="borderLeft";return t=this.vertical?"top":"left",n=this.vertical?"borderBottom":"borderLeft",{[t]:e+"px",[n]:`1px solid ${this.palette.lineColor}`}}},methods:{handleNewLine(e){this.lines.push(e),this.$emit("onLineChange",this.lines,this.vertical)},handleIndicatorShow(e){this.isDraggingLine||(this.showIndicator=!0,this.value=e)},handleIndicatorMove(e){this.showIndicator&&(this.value=e)},handleIndicatorHide(){this.showIndicator=!1},handleLineDown(){this.isDraggingLine=!0},handleLineRelease(e,t){this.isDraggingLine=!1;const n=e-this.start,i=(this.vertical?this.height:this.width)/this.scale;n<0||n>i?this.handleLineRemove(t):(this.lines[t]=e,this.$emit("onLineChange",this.lines,this.vertical))},handleLineRemove(e){this.lines.splice(e,1),this.$emit("onLineChange",this.lines,this.vertical)}}};o("data-v-7b005889");const $={class:"lines"},N={class:"value"};r(),x.render=function(e,t,n,i,s,o){const r=v("CanvasRuler"),b=v("LineRuler");return h(),c("div",{class:m(o.rwClassName),style:f(o.rwStyle)},[g(r,{vertical:n.vertical,scale:n.scale,width:n.width,height:n.height,start:n.start,"select-start":n.selectStart,"select-length":n.selectLength,"canvas-configs":n.canvasConfigs,onOnAddLine:o.handleNewLine,onOnIndicatorShow:o.handleIndicatorShow,onOnIndicatorMove:o.handleIndicatorMove,onOnIndicatorHide:o.handleIndicatorHide},null,8,["vertical","scale","width","height","start","select-start","select-length","canvas-configs","onOnAddLine","onOnIndicatorShow","onOnIndicatorMove","onOnIndicatorHide"]),a(d("div",$,[(h(!0),c(C,null,p(n.lines,((e,t)=>(h(),w(b,{key:e+t,index:t,value:e>>0,scale:n.scale,start:n.start,thick:n.thick,palette:n.palette,vertical:n.vertical,"is-show-refer-line":n.isShowReferLine,onOnRemove:o.handleLineRemove,onOnMouseDown:o.handleLineDown,onOnRelease:o.handleLineRelease},null,8,["index","value","scale","start","thick","palette","vertical","is-show-refer-line","onOnRemove","onOnMouseDown","onOnRelease"])))),128))],512),[[l,n.isShowReferLine]]),a(d("div",{class:"indicator",style:f(o.indicatorStyle)},[d("div",N,u(s.value),1)],4),[[l,s.showIndicator]])],6)},x.__scopeId="data-v-7b005889";const O={bgColor:"#fff",dividerColor:"#DBDBDB",listItem:{textColor:"#415058",hoverTextColor:"#298DF8",disabledTextColor:"rgba(65, 80, 88, 0.4)",bgColor:"#fff",hoverBgColor:"#F2F2F2"}},M={name:"SketchRule",components:{RulerWrapper:x},props:{scale:{type:Number,default:1},ratio:{type:Number,default:window.devicePixelRatio||1},thick:{type:Number,default:16},width:Number,height:Number,startX:{type:Number,default:0},startY:{type:Number,default:0},shadow:{type:Object,default:()=>({x:200,y:100,width:200,height:400})},horLineArr:{type:Array,default:()=>[100,200]},verLineArr:{type:Array,default:()=>[100,200]},cornerActive:Boolean,lang:String,isOpenMenuFeature:{type:Boolean,default:!1},handleShowRuler:{type:Function,default:()=>()=>{}},isShowReferLine:{type:Boolean,default:!0},handleShowReferLine:{type:Function,default:()=>()=>{}},palette:{type:Object,default:()=>({bgColor:"rgba(225,225,225, 0)",longfgColor:"#BABBBC",shortfgColor:"#C8CDD0",fontColor:"#7D8694",shadowColor:"#E8E8E8",lineColor:"#EB5648",borderColor:"#DADADC",cornerActiveColor:"rgb(235, 86, 72, 0.6)",menu:O})}},emits:["onCornerClick","handleLine"],data:()=>({vertical:!0}),computed:{cornerActiveClass(){return this.cornerActive?" active":""},cornerStyle(){return{backgroundColor:this.palette.bgColor,width:this.thick+"px",height:this.thick+"px",borderRight:`1px solid ${this.palette.borderColor}`,borderBottom:`1px solid ${this.palette.borderColor}`}},canvasConfigs(){const{bgColor:e,longfgColor:t,shortfgColor:n,fontColor:i,shadowColor:s,lineColor:o,borderColor:r,cornerActiveColor:a}=this.palette;return{ratio:this.ratio,bgColor:e,longfgColor:t,shortfgColor:n,fontColor:i,shadowColor:s,lineColor:o,borderColor:r,cornerActiveColor:a}}},methods:{onCornerClick(e){this.$emit("onCornerClick",e)},handleLineChange(e,t){const n=t?{h:this.horLineArr,v:[...e]}:{h:[...e],v:this.verLineArr};this.$emit("handleLine",n)}}},I={id:"mb-ruler",class:"style-ruler mb-ruler"};M.render=function(e,t,n,i,s,o){const r=v("RulerWrapper");return h(),c("div",I,[g(r,{vertical:!1,width:n.width,height:n.thick,"is-show-refer-line":n.isShowReferLine,thick:n.thick,start:n.startX,lines:n.horLineArr,"select-start":n.shadow.x,"select-length":n.shadow.width,scale:n.scale,palette:n.palette,"canvas-configs":o.canvasConfigs,onOnLineChange:o.handleLineChange},null,8,["width","height","is-show-refer-line","thick","start","lines","select-start","select-length","scale","palette","canvas-configs","onOnLineChange"]),g(r,{vertical:!0,width:n.thick,height:n.height,"is-show-refer-line":n.isShowReferLine,thick:n.thick,start:n.startY,lines:n.verLineArr,"select-start":n.shadow.y,"select-length":n.shadow.height,scale:n.scale,palette:n.palette,"canvas-configs":o.canvasConfigs,onOnLineChange:o.handleLineChange},null,8,["width","height","is-show-refer-line","thick","start","lines","select-start","select-length","scale","palette","canvas-configs","onOnLineChange"]),d("a",{class:m(["corner",o.cornerActiveClass]),style:f(o.cornerStyle),onClick:t[0]||(t[0]=(...e)=>o.onCornerClick&&o.onCornerClick(...e))},null,6)])};const A={components:{SketchRule:M},data:()=>({scale:2,startX:0,startY:0,lines:{h:[100,200],v:[100,200]},thick:20,lang:"zh-CN",isShowRuler:!0,isShowReferLine:!0}),computed:{shadow:()=>({x:0,y:0,width:160,height:200}),canvasStyle(){return{width:160,height:200,transform:`scale(${this.scale})`}}},mounted(){this.$refs.screensRef.scrollLeft=this.$refs.containerRef.getBoundingClientRect().width/2-300},methods:{handleLine(e){this.lines=e},handleCornerClick(){},handleScroll(){const e=document.querySelector("#screens").getBoundingClientRect(),t=document.querySelector("#canvas").getBoundingClientRect(),n=(e.left+this.thick-t.left)/this.scale,i=(e.top+this.thick-t.top)/this.scale;this.startX=n,this.startY=i},handleWheel(e){if(e.ctrlKey||e.metaKey){e.preventDefault();const t=parseFloat(Math.max(.2,this.scale-e.deltaY/500).toFixed(2));this.scale=t}this.$nextTick((()=>{this.handleScroll()}))}}},B={class:"wrapper"},D={ref:"containerRef",class:"screen-container"};A.render=function(e,t,n,i,s,o){const r=v("SketchRule");return h(),c("div",B,[g(r,{lang:s.lang,thick:s.thick,scale:s.scale,width:582,height:482,"start-x":s.startX,"start-y":s.startY,shadow:o.shadow,"hor-line-arr":s.lines.h,"ver-line-arr":s.lines.v,"corner-active":!0,onHandleLine:o.handleLine,onOnCornerClick:o.handleCornerClick},null,8,["lang","thick","scale","start-x","start-y","shadow","hor-line-arr","ver-line-arr","onHandleLine","onOnCornerClick"]),d("div",{id:"screens",ref:"screensRef",onWheel:t[0]||(t[0]=(...e)=>o.handleWheel&&o.handleWheel(...e)),onScroll:t[1]||(t[1]=(...e)=>o.handleScroll&&o.handleScroll(...e))},[d("div",D,[d("div",{id:"canvas",style:f(o.canvasStyle)},null,4)],512)],544)])};b({setup:e=>(e,t)=>(h(),w(A))}).mount("#app");
