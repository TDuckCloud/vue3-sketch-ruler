var te=Object.defineProperty;var z=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,le=Object.prototype.propertyIsEnumerable;var X=(e,t,n)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,j=(e,t)=>{for(var n in t||(t={}))ne.call(t,n)&&X(e,n,t[n]);if(z)for(var n of z(t))le.call(t,n)&&X(e,n,t[n]);return e};import{c as B,a as $,r as K,n as I,o as N,d as A,b as S,e as T,f as L,w as E,v as Y,t as q,g as G,h as F,i as P,j as _,F as U,k as oe,l as Q,m as ae,p as se,q as Z,u as re,s as ie,x as ce,y as de,z as ue}from"./vendor.ff4dc385.js";const he=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))s(o);new MutationObserver(o=>{for(const a of o)if(a.type==="childList")for(const l of a.addedNodes)l.tagName==="LINK"&&l.rel==="modulepreload"&&s(l)}).observe(document,{childList:!0,subtree:!0});function n(o){const a={};return o.integrity&&(a.integrity=o.integrity),o.referrerpolicy&&(a.referrerPolicy=o.referrerpolicy),o.crossorigin==="use-credentials"?a.credentials="include":o.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(o){if(o.ep)return;o.ep=!0;const a=n(o);fetch(o.href,a)}};he();var M=(e,t)=>{for(const[n,s]of t)e[n]=s;return e};const fe={name:"index",emits:["update:scale","update:ruleWidth","ClickOutside2ClearAll"],data(){return{isShowReferLine:!0,startX:0,startY:0,lines:{h:[],v:[]},shadow:{x:0,y:0},animation:!0,thick:20,width:0,height:0,isImgOpen:!0}},props:{scale:Number,config:Object},computed:{canvasStyle(){return{left:"60px",top:"60px",paddingRight:"20px",paddingBottom:"30px",width:this.config.width+"px",height:this.config.height+"px",transform:`scale(${this.scale})`}}},methods:{getscale(e){this.$emit("update:scale",e)},getruleWidth(e){},imgClick(){this.isShowReferLine=!this.isShowReferLine},setStart(){this.$nextTick(()=>{const e=this.$refs.canvas.getBoundingClientRect(),t=this.$refs.screensRef.getBoundingClientRect(),n=(t.left+this.thick-e.left)/this.scale,s=(t.top+this.thick-e.top)/this.scale;this.startX=n>>0,this.startY=s>>0})},handleWheel(e){if(e.ctrlKey||e.metaKey){e.preventDefault();const t=parseFloat(Math.max(.2,this.scale-e.deltaY/1e3).toFixed(2));t>1.5?this.$emit("update:scale",1.5):t<.5?this.$emit("update:scale",.5):this.$emit("update:scale",t)}this.setStart()},setScrollBack(){this.$refs.screensRef.scrollTop=0}}};function ve(e,t,n,s,o,a){return N(),B("div",{ref:"screensRef",class:"screens",onScroll:t[0]||(t[0]=(...l)=>a.setStart&&a.setStart(...l)),onWheel:t[1]||(t[1]=(...l)=>a.handleWheel&&a.handleWheel(...l)),onClick:t[2]||(t[2]=l=>e.$emit("ClickOutside2ClearAll",l))},[$("div",{class:"canvas-content",ref:"canvas",style:I(a.canvasStyle)},[K(e.$slots,"default",{},void 0,!0)],4)],544)}var ge=M(fe,[["render",ve],["__scopeId","data-v-36e92628"]]);const me={scale:Number,thick:Number,palette:Object,index:Number,start:Number,vertical:Boolean,value:Number,isShowReferLine:Boolean};const we=A({name:"LineRuler",props:me,emits:["onMouseDown","onRelease","onRemove"],setup(e,{emit:t}){const n=S(0),s=S(!0);T(()=>{n.value=e.value});const o=v=>{s.value=v>=0},a=L(()=>{const v=(n.value-e.start)*e.scale;o(v);const u=v+"px";return e.vertical?{top:u}:{left:u}}),l=L(()=>{var d;const v=`1px solid ${(d=e.palette)==null?void 0:d.lineColor}`,u=e.vertical?{borderTop:v}:{borderLeft:v},i=e.isShowReferLine?e.vertical?"ns-resize":"ew-resize":"none";return j({cursor:i},u)}),f=L(()=>e.vertical?{left:e.thick+"px"}:{top:e.thick+"px"});return{startValue:n,showLine:s,offset:a,borderCursor:l,actionStyle:f,handleDown:v=>{const u=e.vertical?v.clientY:v.clientX,i=n.value;t("onMouseDown");const d=k=>{const r=e.vertical?k.clientY:k.clientX,g=Math.round(i+(r-u)/e.scale);n.value=g},c=()=>{t("onRelease",n.value,e.index),document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",c)};document.addEventListener("mousemove",d),document.addEventListener("mouseup",c)},handleRemove:()=>{t("onRemove",e.index)}}}}),Ce={class:"value"};function pe(e,t,n,s,o,a){return E((N(),B("div",{class:"line",style:I([e.offset,e.borderCursor]),onMousedown:t[1]||(t[1]=(...l)=>e.handleDown&&e.handleDown(...l))},[$("div",{class:"action",style:I(e.actionStyle)},[$("span",{class:"del",onClick:t[0]||(t[0]=(...l)=>e.handleRemove&&e.handleRemove(...l))},"\xD7"),$("span",Ce,q(e.startValue),1)],4)],36)),[[Y,e.showLine]])}var ye=M(we,[["render",pe],["__scopeId","data-v-09f2ee78"]]);const J=e=>e<=.25?40:e<=.5?20:e<=1?10:e<=2?5:e<=4?2:1,V=.83,Se=(e,t,n,s)=>{const{scale:o,width:a,height:l,palette:f}=s,{bgColor:p,fontColor:R,shadowColor:v,ratio:u,longfgColor:i,shortfgColor:d}=f;if(e.scale(u,u),e.clearRect(0,0,a,l),e.fillStyle=p,e.fillRect(0,0,a,l),n){const h=(n.x-t)*o,w=n.width*o;e.fillStyle=v,e.fillRect(h,0,w,l*3/8)}const c=J(o),k=c*o,r=c*10,g=r*o,b=Math.floor(t/c)*c,O=Math.floor(t/r)*r,D=(b-t)/c*k,m=(O-t)/r*g,y=t+Math.ceil(a/o);e.beginPath(),e.fillStyle=R,e.strokeStyle=i;for(let h=O,w=0;h<y;h+=r,w++){const C=m+w*g+.5;e.moveTo(C,0),e.save(),e.translate(C,l*.4),e.scale(V/u,V/u),e.fillText(h.toString(),4*u,7*u),e.restore(),e.lineTo(C,l*9/16)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=d;for(let h=b,w=0;h<y;h+=c,w++){const C=D+w*k+.5;e.moveTo(C,0),h%r!=0&&e.lineTo(C,l*1/4)}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},Le=(e,t,n,s)=>{const{scale:o,width:a,height:l,palette:f}=s,{bgColor:p,fontColor:R,shadowColor:v,ratio:u,longfgColor:i,shortfgColor:d}=f;if(e.scale(u,u),e.clearRect(0,0,a,l),e.fillStyle=p,e.fillRect(0,0,a,l),n){const h=(n.y-t)*o,w=n.height*o;e.fillStyle=v,e.fillRect(0,h,a*3/8,w)}const c=J(o),k=c*o,r=c*10,g=r*o,b=Math.floor(t/c)*c,O=Math.floor(t/r)*r,D=(b-t)/c*k,m=(O-t)/r*g,y=t+Math.ceil(l/o);e.beginPath(),e.fillStyle=R,e.strokeStyle=i;for(let h=O,w=0;h<y;h+=r,w++){const C=m+w*g+.5;e.moveTo(0,C),e.save(),e.translate(a*.4,C),e.rotate(-Math.PI/2),e.scale(V/u,V/u),e.fillText(h.toString(),4*u,7*u),e.restore(),e.lineTo(a*9/16,C)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=d;for(let h=b,w=0;h<y;h+=c,w++){const C=D+w*k+.5;e.moveTo(0,C),h%r!=0&&e.lineTo(a*1/4,C)}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},Re={scale:Number,ratio:Number,palette:Object,vertical:Boolean,start:Number,width:Number,height:Number,selectStart:Number,selectLength:Number},ke=A({name:"CanvasRuler",props:Re,emits:["onAddLine","onIndicatorShow","onIndicatorMove","onIndicatorHide"],setup(e,{emit:t}){const n=G({canvasContext:null}),s=S(null);T(()=>{o(),a(),l()});const o=()=>{n.canvasContext=s.value&&s.value.getContext("2d")},a=()=>{if(s.value){const i=e.ratio;console.log(i),s.value.width=e.width*i,s.value.height=e.height*i;const d=n.canvasContext;d&&(d.font=`${12*i}px -apple-system,
                "Helvetica Neue", ".SFNSText-Regular",
                "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB",
                "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif`,d.lineWidth=1,d.textBaseline="middle")}},l=()=>{const i={scale:e.scale,width:e.width,height:e.height,palette:e.palette};e.vertical&&n.canvasContext?Le(n.canvasContext,e.start,{y:e.selectStart,height:e.selectLength},i):n.canvasContext&&Se(n.canvasContext,e.start,{x:e.selectStart,width:e.selectLength},i)};F(()=>e.start,()=>l()),F([()=>e.width,()=>e.height],()=>{a(),l()}),F([()=>e.scale],i=>{console.log(i,"666666666")});const f=(i,d,c)=>Math.round(d+i/c);return{state:n,canvas:s,initCanvasRef:o,handleClick:i=>{const d=e.vertical?i.offsetY:i.offsetX,c=f(d,e.start,e.scale);t("onAddLine",c)},handleEnter:i=>{const d=e.vertical?i.offsetY:i.offsetX,c=f(d,e.start,e.scale);t("onIndicatorShow",c)},handleMove:i=>{const d=e.vertical?i.offsetY:i.offsetX,c=f(d,e.start,e.scale);t("onIndicatorMove",c)},handleLeave:()=>{t("onIndicatorHide")}}}});function be(e,t,n,s,o,a){return N(),B("canvas",{ref:"canvas",class:"ruler",onClick:t[0]||(t[0]=(...l)=>e.handleClick&&e.handleClick(...l)),onMouseenter:t[1]||(t[1]=(...l)=>e.handleEnter&&e.handleEnter(...l)),onMousemove:t[2]||(t[2]=(...l)=>e.handleMove&&e.handleMove(...l)),onMouseleave:t[3]||(t[3]=(...l)=>e.handleLeave&&e.handleLeave(...l))},null,544)}var $e=M(ke,[["render",be]]);const Oe={scale:Number,ratio:Number,thick:Number,palette:Object,vertical:{type:Boolean,default:!0},width:{type:Number,default:200},height:{type:Number,default:200},start:{type:Number,default:0},lines:{type:Array,default:()=>[100,200]},selectStart:{type:Number},selectLength:{type:Number},isShowReferLine:{type:Boolean}};const Ne=A({name:"RulerWrapper",components:{CanvasRuler:$e,RulerLine:ye},props:Oe,emits:["onLineChange"],setup(e,{emit:t}){const n=S(!1),s=S(!1),o=S(0),a=L(()=>e.vertical?"v-container":"h-container"),l=L(()=>{const r={width:`calc(100% - ${e.thick}px)`,height:`${e.thick+1}px`,left:`${e.thick}px`},g={width:`${e.thick&&e.thick+1}px`,height:`calc(100% - ${e.thick}px)`,top:`${e.thick}px`};return e.vertical?g:r}),f=L(()=>{var r;return{borderTop:`1px solid ${(r=e.palette)==null?void 0:r.lineColor}`,cursor:e.isShowReferLine?"ns-resize":"none"}}),p=L(()=>{var O;const r=(o.value-e.start)*e.scale;let g="top",b="borderLeft";return g=e.vertical?"top":"left",b=e.vertical?"borderBottom":"borderLeft",{[g]:r+"px",[b]:`1px solid ${(O=e.palette)==null?void 0:O.lineColor}`}}),R=r=>{e.lines.push(r),t("onLineChange",e.lines,e.vertical)},v=r=>{n.value||(s.value=!0,o.value=r)},u=r=>{s.value&&(o.value=r)},i=()=>{s.value=!1},d=()=>{n.value=!0},c=(r,g)=>{n.value=!1;const b=r-e.start,O=(e.vertical?e.height:e.width)/e.scale;b<0||b>O?k(g):(e.lines[g]=r,t("onLineChange",e.lines,e.vertical))},k=r=>{e.lines.splice(r,1),t("onLineChange",e.lines,e.vertical)};return{isDraggingLine:n,showIndicator:s,valueNum:o,rwClassName:a,rwStyle:l,lineStyle:f,indicatorStyle:p,handleNewLine:R,handleLineDown:d,handleLineRelease:c,handleIndicatorMove:u,handleIndicatorShow:v,handleIndicatorHide:i,handleLineRemove:k}}}),Be={class:"lines"},Ie={class:"value"};function Me(e,t,n,s,o,a){const l=P("CanvasRuler"),f=P("RulerLine");return N(),B("div",{class:Q(e.rwClassName),style:I(e.rwStyle)},[_(l,{vertical:e.vertical,scale:e.scale,width:e.width,height:e.height,start:e.start,ratio:e.ratio,"select-start":e.selectStart,"select-length":e.selectLength,palette:e.palette,onOnAddLine:e.handleNewLine,onOnIndicatorShow:e.handleIndicatorShow,onOnIndicatorMove:e.handleIndicatorMove,onOnIndicatorHide:e.handleIndicatorHide},null,8,["vertical","scale","width","height","start","ratio","select-start","select-length","palette","onOnAddLine","onOnIndicatorShow","onOnIndicatorMove","onOnIndicatorHide"]),E($("div",Be,[(N(!0),B(U,null,oe(e.lines,(p,R)=>(N(),ae(f,{key:p+R,index:R,value:p>>0,scale:e.scale,start:e.start,thick:e.thick,palette:e.palette,vertical:e.vertical,"is-show-refer-line":e.isShowReferLine,onOnRemove:e.handleLineRemove,onOnMouseDown:e.handleLineDown,onOnRelease:e.handleLineRelease},null,8,["index","value","scale","start","thick","palette","vertical","is-show-refer-line","onOnRemove","onOnMouseDown","onOnRelease"]))),128))],512),[[Y,e.isShowReferLine]]),E($("div",{class:"indicator",style:I(e.indicatorStyle)},[$("div",Ie,q(e.valueNum),1)],4),[[Y,e.showIndicator]])],6)}var Ae=M(Ne,[["render",Me],["__scopeId","data-v-901d437c"]]);const _e={config:Object,ratio:{type:Number,default:1},thick:{type:Number,default:16},palette:Object,shadow:Object,horLineArr:{type:Array,default:()=>[100,200]},verLineArr:{type:Array,default:()=>[100,200]},cornerActive:{type:Boolean,default:!1},isShowReferLine:{type:Boolean,default:!0}};const De=A({name:"SketchRule",components:{RulerWrapper:Ae,InnerBox:ge},props:_e,emits:["onCornerClick","handleLine","ClickOutside2ClearAll"],setup(e,{slots:t,emit:n}){let s=S(1);const o=S(!0),a=L(()=>Z({x:0,y:0,width:200,height:200},e.shadow||{})),l=L(()=>Z({bgColor:"rgba(225,225,225, 0)",longfgColor:"#BABBBC",shortfgColor:"#C8CDD0",fontColor:"#7D8694",shadowColor:"#E8E8E8",lineColor:"#EB5648",borderColor:"#DADADC",cornerActiveColor:"rgb(235, 86, 72, 0.6)",menu:{bgColor:"#fff",dividerColor:"#DBDBDB",listItem:{textColor:"#415058",hoverTextColor:"#298DF8",disabledTextColor:"rgba(65, 80, 88, 0.4)",bgColor:"#fff",hoverBgColor:"#F2F2F2"}}},e.palette||{})),f=L(()=>e.cornerActive?" active":""),p=S(null);let R=S(0),v=S(0);T(()=>{if(p.value){const m=p.value.getBoundingClientRect();R.value=m.width-21,v.value=m.height-21}g()});const u=L(()=>({backgroundColor:l.value.bgColor,width:e.thick+"px",height:e.thick+"px",borderRight:`1px solid ${l.value.borderColor}`,borderBottom:`1px solid ${l.value.borderColor}`})),i=L(()=>({left:"60px",top:"60px",paddingRight:"20px",paddingBottom:"30px",transform:`scale(${s.value})`}));let d=S(0),c=S(0);const k=()=>{e.isShowReferLine=!e.isShowReferLine},r=S(null),g=()=>{se(()=>{if(r.value&&t.default&&t.default()[0].el){const y=t.default()[0].el.getBoundingClientRect(),h=r.value.getBoundingClientRect(),w=(h.left+e.thick-y.left)/s.value,C=(h.top+e.thick-y.top)/s.value;d.value=w>>0,c.value=C>>0,console.log(d.value,c.value)}})};return{setStart:g,handleWheel:m=>{if(m.ctrlKey||m.metaKey){m.preventDefault();const y=parseFloat(Math.max(.2,s.value-m.deltaY/1e3).toFixed(2));y>1.5?s.value=1.5:y<.5?s.value=.5:s.value=y}g()},screensRef:r,startY:c,startX:d,imgClick:k,canvasStyle:i,isImgOpen:o,scale:s,width:R,height:v,ruler:p,paletteCpu:l,shadowCpu:a,cornerActiveClass:f,cornerStyle:u,onCornerClick:m=>{n("onCornerClick",m)},handleLineChange:(m,y)=>{const h=y?{h:e.horLineArr,v:[...m]}:{h:[...m],v:e.verLineArr};n("handleLine",h)}}}}),Te={ref:"ruler",class:"style-ruler"};function Pe(e,t,n,s,o,a){const l=P("RulerWrapper");return N(),B("div",Te,[_(l,{vertical:!1,width:e.width,height:e.thick,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startX,lines:e.horLineArr,"select-start":e.shadowCpu.x,"select-length":e.shadowCpu.width,scale:e.scale,palette:e.paletteCpu,onOnLineChange:e.handleLineChange},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette","onOnLineChange"]),_(l,{vertical:!0,width:e.thick,height:e.height,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startY,lines:e.verLineArr,"select-start":e.shadowCpu.y,"select-length":e.shadowCpu.height,scale:e.scale,palette:e.paletteCpu,onOnLineChange:e.handleLineChange},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette","onOnLineChange"]),$("a",{class:Q(["corner",e.cornerActiveClass]),style:I(e.cornerStyle),onClick:t[0]||(t[0]=(...f)=>e.onCornerClick&&e.onCornerClick(...f))},null,6),$("div",{ref:"screensRef",class:"screens",onMousewheel:t[1]||(t[1]=(...f)=>e.handleWheel&&e.handleWheel(...f)),onClick:t[2]||(t[2]=f=>e.$emit("ClickOutside2ClearAll",f))},[$("div",{class:"canvas-content",style:I(e.canvasStyle)},[K(e.$slots,"default",{},void 0,!0)],4)],544)],512)}var W=M(De,[["render",Pe],["__scopeId","data-v-02636fc8"]]);W.install=e=>{e.component(W.name,W)};const H=A({components:{SketchRule:W},setup(){const e=G({scale:1,wrapperwith:1200,wrapperheight:500,lines:{h:[0,200],v:[0,200]},thick:20,isShowRuler:!0,isShowReferLine:!0}),t=L(()=>e.wrapperwith+22+"px"),n=L(()=>e.wrapperheight+22+"px");return T(()=>{window.addEventListener("resize",()=>{e.wrapperwith=window.innerWidth-400,e.wrapperheight=window.innerHeight-400})}),{wrapperwithpx:t,wrapperheightpx:n,state:e,handleLine:o=>{e.lines=o}}}}),x=()=>{re(e=>({"7f2ee42d":e.wrapperwithpx,"7264f48e":e.wrapperheightpx}))},ee=H.setup;H.setup=ee?(e,t)=>(x(),ee(e,t)):x;const Ve=H,We=e=>(ce("data-v-76ed7854"),e=e(),de(),e),Ee=We(()=>$("div",{class:"constent"},null,-1));function Ye(e,t,n,s,o,a){const l=P("SketchRule");return N(),B("div",null,[_(l,{class:"wrapper",thick:e.state.thick,scale:e.state.scale,"hor-line-arr":e.state.lines.h,"ver-line-arr":e.state.lines.v,"corner-active":!0,onHandleLine:e.handleLine},{default:ie(()=>[Ee]),_:1},8,["thick","scale","hor-line-arr","ver-line-arr","onHandleLine"])])}var Fe=M(Ve,[["render",Ye],["__scopeId","data-v-76ed7854"]]);const He=$("span",null,"2021/10/21",-1),ze={setup(e){return(t,n)=>(N(),B(U,null,[He,_(Fe)],64))}},Xe=ue(ze);Xe.mount("#app");
