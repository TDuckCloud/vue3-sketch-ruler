var x=Object.defineProperty;var j=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,te=Object.prototype.propertyIsEnumerable;var z=(e,t,n)=>t in e?x(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,H=(e,t)=>{for(var n in t||(t={}))ee.call(t,n)&&z(e,n,t[n]);if(j)for(var n of j(t))te.call(t,n)&&z(e,n,t[n]);return e};import{d as L,r as b,o as M,c as m,w as P,v as T,a as R,b as f,t as F,n as $,e as C,f as K,g as _,h as A,i as B,F as E,j as ne,k as U,l as oe,m as ae,p as le}from"./vendor.b3fdb269.js";const re=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))u(i);new MutationObserver(i=>{for(const l of i)if(l.type==="childList")for(const o of l.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&u(o)}).observe(document,{childList:!0,subtree:!0});function n(i){const l={};return i.integrity&&(l.integrity=i.integrity),i.referrerpolicy&&(l.referrerPolicy=i.referrerpolicy),i.crossorigin==="use-credentials"?l.credentials="include":i.crossorigin==="anonymous"?l.credentials="omit":l.credentials="same-origin",l}function u(i){if(i.ep)return;i.ep=!0;const l=n(i);fetch(i.href,l)}};re();const se={scale:Number,thick:Number,palette:Object,index:Number,start:Number,vertical:Boolean,value:Number,isShowReferLine:Boolean};var O=(e,t)=>{for(const[n,u]of t)e[n]=u;return e};const ie=L({name:"LineRuler",props:se,emits:["onMouseDown","onRelease","onRemove"],setup(e,{emit:t}){const n=b(0),u=b(!0);M(()=>{n.value=e.value});const i=s=>{u.value=s>=0},l=m(()=>{const s=(n.value-e.start)*e.scale;i(s);const d=s+"px";return e.vertical?{top:d}:{left:d}}),o=m(()=>{var g;const s=`1px solid ${(g=e.palette)==null?void 0:g.lineColor}`,d=e.vertical?{borderTop:s}:{borderLeft:s},h=e.isShowReferLine?e.vertical?"ns-resize":"ew-resize":"none";return H({cursor:h},d)}),c=m(()=>e.vertical?{left:e.thick+"px"}:{top:e.thick+"px"});return{startValue:n,showLine:u,offset:l,borderCursor:o,actionStyle:c,handleDown:s=>{const d=e.vertical?s.clientY:s.clientX,h=n.value;t("onMouseDown");const g=S=>{const p=e.vertical?S.clientY:S.clientX,D=Math.round(h+(p-d)/e.scale);n.value=D},k=()=>{t("onRelease",n.value,e.index),document.removeEventListener("mousemove",g),document.removeEventListener("mouseup",k)};document.addEventListener("mousemove",g),document.addEventListener("mouseup",k)},handleRemove:()=>{t("onRemove",e.index)}}}}),ce={class:"value"};function ue(e,t,n,u,i,l){return P((C(),R("div",{class:"line",style:$([e.offset,e.borderCursor]),onMousedown:t[1]||(t[1]=(...o)=>e.handleDown&&e.handleDown(...o))},[f("div",{class:"action",style:$(e.actionStyle)},[f("span",{class:"del",onClick:t[0]||(t[0]=(...o)=>e.handleRemove&&e.handleRemove(...o))},"\xD7"),f("span",ce,F(e.startValue),1)],4)],36)),[[T,e.showLine]])}var de=O(ie,[["render",ue],["__scopeId","data-v-069c473f"]]);const he=e=>e<=.25?40:e<=.5?20:e<=1?10:e<=2?5:e<=4?2:1,q=.83,fe=(e,t,n,u,i,l)=>{const{scale:o,width:c,height:a,ratio:r,palette:s}=i,{bgColor:d,fontColor:h,shadowColor:g,longfgColor:k,shortfgColor:S}=s;if(e.scale(r,r),e.clearRect(0,0,c,a),e.fillStyle=d,e.fillRect(0,0,c,a),u){const w=(n-t)*o,y=u*o;e.fillStyle=g,l?e.fillRect(w,0,y,a*3/8):e.fillRect(0,w,c*3/8,y)}const p=he(o),D=p*o,N=p*10,W=N*o,V=Math.floor(t/p)*p,X=Math.floor(t/N)*N,Z=(V-t)/p*D,J=(X-t)/N*W,Y=t+Math.ceil((l?c:a)/o);e.beginPath(),e.fillStyle=h,e.strokeStyle=k;for(let w=X,y=0;w<Y;w+=N,y++){const v=J+y*W+.5;l?e.moveTo(v,0):e.moveTo(0,v),e.save(),l?e.translate(v,a*.4):e.translate(c*.4,v),l||e.rotate(-Math.PI/2),e.scale(q/r,q/r),e.fillText(w.toString(),4*r,7*r),e.restore(),l?e.lineTo(v,a*9/16):e.lineTo(c*9/16,v)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=S;for(let w=V,y=0;w<Y;w+=p,y++){const v=Z+y*D+.5;l?e.moveTo(v,0):e.moveTo(0,v),w%N!=0&&(l?e.lineTo(v,a*1/4):e.lineTo(c*1/4,v))}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},ve={showIndicator:Boolean,valueNum:Number,scale:Number,ratio:Number,palette:Object,vertical:Boolean,start:Number,width:Number,height:Number,selectStart:Number,selectLength:Number},me=L({name:"CanvasRuler",props:ve,emits:["onAddLine","update:showIndicator","update:valueNum"],setup(e,{emit:t}){const n=K({canvasContext:null}),u=b(null);M(()=>{i(),l(),o()});const i=()=>{n.canvasContext=u.value&&u.value.getContext("2d")},l=()=>{if(u.value){const a=e.ratio;u.value.width=e.width*a,u.value.height=e.height*a;const r=n.canvasContext;r&&(r.font=`${12*a}px -apple-system,
                "Helvetica Neue", ".SFNSText-Regular",
                "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB",
                "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif`,r.lineWidth=1,r.textBaseline="middle")}},o=()=>{const a={scale:e.scale,width:e.width,height:e.height,palette:e.palette,ratio:e.ratio};n.canvasContext&&fe(n.canvasContext,e.start,e.selectStart,e.selectLength,a,!e.vertical)};return _(()=>e.start,()=>o()),_([()=>e.width,()=>e.height],()=>{l(),o()}),{handle:(a,r)=>{const s=(g,k,S)=>Math.round(k+g/S),d=e.vertical?a.offsetY:a.offsetX,h=s(d,e.start,e.scale);switch(r){case"click":t("onAddLine",h);break;case"enter":t("update:valueNum",h),t("update:showIndicator",!0);break;default:t("update:valueNum",h);break}},canvas:u}}});function we(e,t,n,u,i,l){return C(),R("canvas",{ref:"canvas",class:"ruler",onClick:t[0]||(t[0]=o=>e.handle(o,"click")),onMouseenter:t[1]||(t[1]=o=>e.handle(o,"enter")),onMousemove:t[2]||(t[2]=o=>e.handle(o,"move")),onMouseleave:t[3]||(t[3]=o=>e.$emit("update:showIndicator",!1))},null,544)}var ge=O(me,[["render",we]]);const pe={scale:Number,ratio:Number,thick:Number,palette:Object,vertical:{type:Boolean,default:!0},width:{type:Number,default:200},height:{type:Number,default:200},start:{type:Number,default:0},lines:{type:Array,default:()=>[]},selectStart:{type:Number},selectLength:{type:Number},isShowReferLine:{type:Boolean}};const ye=L({name:"RulerWrapper",components:{CanvasRuler:ge,RulerLine:de},props:pe,setup(e){const t=b(!1),n=b(0),u=m(()=>e.vertical?"v-container":"h-container"),i=m(()=>{const r={width:`calc(100% - ${e.thick}px)`,height:`${e.thick+1}px`,left:`${e.thick}px`},s={width:`${e.thick&&e.thick+1}px`,height:`calc(100% - ${e.thick}px)`,top:`${e.thick}px`};return e.vertical?s:r}),l=m(()=>{var h;const r=(n.value-e.start)*e.scale;let s="top",d="borderLeft";return s=e.vertical?"top":"left",d=e.vertical?"borderBottom":"borderLeft",{[s]:r+"px",[d]:`1px solid ${(h=e.palette)==null?void 0:h.lineColor}`}}),o=r=>{e.lines.push(r)},c=(r,s)=>{const d=r-e.start,h=(e.vertical?e.height:e.width)/e.scale;d<0||d>h?a(s):e.lines[s]=r},a=r=>{e.lines.splice(r,1)};return{showIndicator:t,valueNum:n,rwClassName:u,rwStyle:i,indicatorStyle:l,handleNewLine:o,handleLineRelease:c,handleLineRemove:a}}}),Ce={class:"lines"},be={class:"value"};function Re(e,t,n,u,i,l){const o=A("CanvasRuler"),c=A("RulerLine");return C(),R("div",{class:U(e.rwClassName),style:$(e.rwStyle)},[B(o,{vertical:e.vertical,scale:e.scale,width:e.width,height:e.height,start:e.start,ratio:e.ratio,"select-start":e.selectStart,"select-length":e.selectLength,palette:e.palette,valueNum:e.valueNum,"onUpdate:valueNum":t[0]||(t[0]=a=>e.valueNum=a),showIndicator:e.showIndicator,"onUpdate:showIndicator":t[1]||(t[1]=a=>e.showIndicator=a),onOnAddLine:e.handleNewLine},null,8,["vertical","scale","width","height","start","ratio","select-start","select-length","palette","valueNum","showIndicator","onOnAddLine"]),P(f("div",Ce,[(C(!0),R(E,null,ne(e.lines,(a,r)=>(C(),oe(c,{key:a+r,index:r,value:a>>0,scale:e.scale,start:e.start,thick:e.thick,palette:e.palette,vertical:e.vertical,"is-show-refer-line":e.isShowReferLine,onOnRemove:e.handleLineRemove,onOnRelease:e.handleLineRelease},null,8,["index","value","scale","start","thick","palette","vertical","is-show-refer-line","onOnRemove","onOnRelease"]))),128))],512),[[T,e.isShowReferLine]]),P(f("div",{class:"indicator",style:$(e.indicatorStyle)},[f("div",be,F(e.valueNum),1)],4),[[T,e.showIndicator]])],6)}var ke=O(ye,[["render",Re],["__scopeId","data-v-adb71e78"]]);const Se={scale:{type:Number,default:1},ratio:{type:Number,default:window.devicePixelRatio||1},thick:{type:Number,default:16},palette:Object,startX:{type:Number},startY:{type:Number,default:0},width:{type:Number,default:200},height:{type:Number,default:200},shadow:{type:Object,default:()=>({x:0,y:0,width:0,height:0})},lines:{type:Object,default:()=>({h:[],v:[]})},cornerActive:{type:Boolean,default:!1},isShowReferLine:{type:Boolean,default:!0}};const Ne=L({name:"SketchRule",components:{RulerWrapper:ke},props:Se,emits:["onCornerClick","handleLine"],setup(e,{emit:t}){const n=m(()=>{function o(a,r){return Object.keys(a).forEach(s=>{s&&a.hasOwnProperty(s)&&(typeof r.key=="object"?a[s]=o(a[s],r[s]):r.hasOwnProperty(s)&&(a[s]=r[s]))}),a}return o({bgColor:"rgba(225,225,225, 0)",longfgColor:"#BABBBC",shortfgColor:"#C8CDD0",fontColor:"#7D8694",shadowColor:"#E8E8E8",lineColor:"#EB5648",borderColor:"#DADADC",cornerActiveColor:"rgb(235, 86, 72, 0.6)",menu:{bgColor:"#fff",dividerColor:"#DBDBDB",listItem:{textColor:"#415058",hoverTextColor:"#298DF8",disabledTextColor:"rgba(65, 80, 88, 0.4)",bgColor:"#fff",hoverBgColor:"#F2F2F2"}}},e.palette||{})}),u=m(()=>e.cornerActive?" active":""),i=m(()=>({backgroundColor:n.value.bgColor,width:e.thick+"px",height:e.thick+"px",borderRight:`1px solid ${n.value.borderColor}`,borderBottom:`1px solid ${n.value.borderColor}`}));return{paletteCpu:n,cornerActiveClass:u,cornerStyle:i,onCornerClick:o=>{t("onCornerClick",o)}}}}),$e={id:"mb-ruler",class:"style-ruler mb-ruler"};function Le(e,t,n,u,i,l){const o=A("RulerWrapper");return C(),R("div",$e,[B(o,{vertical:!1,width:e.width,height:e.thick,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startX,lines:e.lines.h,"select-start":e.shadow.x,"select-length":e.shadow.width,scale:e.scale,palette:e.paletteCpu},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette"]),B(o,{vertical:!0,width:e.thick,height:e.height,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startY,lines:e.lines.v,"select-start":e.shadow.y,"select-length":e.shadow.height,scale:e.scale,palette:e.paletteCpu},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette"]),f("a",{class:U(["corner",e.cornerActiveClass]),style:$(e.cornerStyle),onClick:t[0]||(t[0]=(...c)=>e.onCornerClick&&e.onCornerClick(...c))},null,6)])}var I=O(Ne,[["render",Le]]);I.install=e=>{e.component(I.name,I)};const G=600,Q=320,Be=L({components:{SketchRule:I},setup(){const e=b(null),t=b(null),n=K({scale:2,startX:0,startY:0,lines:{h:[433,588],v:[33,143]},thick:20,isShowRuler:!0,isShowReferLine:!0}),u=m(()=>({x:0,y:0,width:G,height:Q})),i=m(()=>({width:G,height:Q,transform:`scale(${n.scale})`}));M(()=>{e.value.scrollLeft=t.value.getBoundingClientRect().width/2-400});const l=()=>{const c=document.querySelector("#screens").getBoundingClientRect(),a=document.querySelector("#canvas").getBoundingClientRect(),r=(c.left+n.thick-a.left)/n.scale,s=(c.top+n.thick-a.top)/n.scale;n.startX=r,n.startY=s};return{screensRef:e,containerRef:t,state:n,shadow:u,canvasStyle:i,handleWheel:c=>{if(c.ctrlKey||c.metaKey){c.preventDefault();const a=parseFloat(Math.max(.2,n.scale-c.deltaY/500).toFixed(2));n.scale=a}ae(()=>{l()})},handleScroll:l}}}),Oe={class:"top"},De={class:"wrapper"},Ae={ref:"containerRef",class:"screen-container"};function Ie(e,t,n,u,i,l){const o=A("SketchRule");return C(),R(E,null,[f("div",Oe,"\u7F29\u653E\u6BD4\u4F8B:"+F(e.state.scale),1),f("div",De,[B(o,{thick:e.state.thick,scale:e.state.scale,width:1380,height:780,"start-x":e.state.startX,"start-y":e.state.startY,shadow:e.shadow,"corner-active":!0,lines:e.state.lines},null,8,["thick","scale","start-x","start-y","shadow","lines"]),f("div",{id:"screens",ref:"screensRef",onWheel:t[0]||(t[0]=(...c)=>e.handleWheel&&e.handleWheel(...c)),onScroll:t[1]||(t[1]=(...c)=>e.handleScroll&&e.handleScroll(...c))},[f("div",Ae,[f("div",{id:"canvas",style:$(e.canvasStyle)},null,4)],512)],544)])],64)}var Me=O(Be,[["render",Ie]]);const Pe=f("div",null,[f("a",{href:"https://data.avuejs.com/build/1",target:"_blank",class:"redlink"}," \u5B9E\u4F8B\u5730\u5740:https://data.avuejs.com/build/1 "),f("div",null,"\u6309\u4F4FCtril+\u9F20\u6807\u6EDA\u8F6E\u53EF\u4EE5\u7F29\u653E\u9875\u9762")],-1),Te={setup(e){return(t,n)=>(C(),R(E,null,[Pe,B(Me)],64))}},Fe=le(Te);Fe.mount("#app");
