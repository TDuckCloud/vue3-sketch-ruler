var ee=Object.defineProperty;var Y=Object.getOwnPropertySymbols;var te=Object.prototype.hasOwnProperty,ne=Object.prototype.propertyIsEnumerable;var X=(e,t,n)=>t in e?ee(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,z=(e,t)=>{for(var n in t||(t={}))te.call(t,n)&&X(e,n,t[n]);if(Y)for(var n of Y(t))ne.call(t,n)&&X(e,n,t[n]);return e};import{d as $,r as b,o as I,c as g,w as T,v as P,a as S,b as w,t as j,n as L,e as R,f as H,g as K,h as M,i as B,F as U,j as oe,k as q,l as le,m as ae,p as re}from"./vendor.5f32e9d3.js";const se=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))c(r);new MutationObserver(r=>{for(const a of r)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&c(o)}).observe(document,{childList:!0,subtree:!0});function n(r){const a={};return r.integrity&&(a.integrity=r.integrity),r.referrerpolicy&&(a.referrerPolicy=r.referrerpolicy),r.crossorigin==="use-credentials"?a.credentials="include":r.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function c(r){if(r.ep)return;r.ep=!0;const a=n(r);fetch(r.href,a)}};se();const ie={scale:Number,thick:Number,palette:Object,index:Number,start:Number,vertical:Boolean,value:Number,isShowReferLine:Boolean};var D=(e,t)=>{for(const[n,c]of t)e[n]=c;return e};const ce=$({name:"LineRuler",props:ie,emits:["onMouseDown","onRelease","onRemove"],setup(e,{emit:t}){const n=b(0),c=b(!0);I(()=>{n.value=e.value});const r=i=>{c.value=i>=0},a=g(()=>{const i=(n.value-e.start)*e.scale;r(i);const u=i+"px";return e.vertical?{top:u}:{left:u}}),o=g(()=>{var h;const i=`1px solid ${(h=e.palette)==null?void 0:h.lineColor}`,u=e.vertical?{borderTop:i}:{borderLeft:i},f=e.isShowReferLine?e.vertical?"ns-resize":"ew-resize":"none";return z({cursor:f},u)}),s=g(()=>e.vertical?{left:e.thick+"px"}:{top:e.thick+"px"});return{startValue:n,showLine:c,offset:a,borderCursor:o,actionStyle:s,handleDown:i=>{const u=e.vertical?i.clientY:i.clientX,f=n.value;t("onMouseDown");const h=k=>{const C=e.vertical?k.clientY:k.clientX,O=Math.round(f+(C-u)/e.scale);n.value=O},v=()=>{t("onRelease",n.value,e.index),document.removeEventListener("mousemove",h),document.removeEventListener("mouseup",v)};document.addEventListener("mousemove",h),document.addEventListener("mouseup",v)},handleRemove:()=>{t("onRemove",e.index)}}}}),ue={class:"value"};function de(e,t,n,c,r,a){return T((R(),S("div",{class:"line",style:L([e.offset,e.borderCursor]),onMousedown:t[1]||(t[1]=(...o)=>e.handleDown&&e.handleDown(...o))},[w("div",{class:"action",style:L(e.actionStyle)},[w("span",{class:"del",onClick:t[0]||(t[0]=(...o)=>e.handleRemove&&e.handleRemove(...o))},"\xD7"),w("span",ue,j(e.startValue),1)],4)],36)),[[P,e.showLine]])}var he=D(ce,[["render",de],["__scopeId","data-v-069c473f"]]);const fe=e=>e<=.25?40:e<=.5?20:e<=1?10:e<=2?5:e<=4?2:1,G=.83,_=(e,t,n,c,r,a)=>{const{scale:o,width:s,height:l,palette:d}=r,{bgColor:i,fontColor:u,shadowColor:f,ratio:h,longfgColor:v,shortfgColor:k}=d;if(e.scale(h,h),e.clearRect(0,0,s,l),e.fillStyle=i,e.fillRect(0,0,s,l),c){const p=(n-t)*o,y=c*o;e.fillStyle=f,a?e.fillRect(p,0,y,l*3/8):e.fillRect(0,p,s*3/8,y)}const C=fe(o),O=C*o,N=C*10,E=N*o,F=Math.floor(t/C)*C,V=Math.floor(t/N)*N,J=(F-t)/C*O,x=(V-t)/N*E,W=t+Math.ceil(a?s:l/o);e.beginPath(),e.fillStyle=u,e.strokeStyle=v;for(let p=V,y=0;p<W;p+=N,y++){const m=x+y*E+.5;e.moveTo(m,0),e.save(),a?e.translate(m,l*.4):e.translate(s*.4,m),a||e.rotate(-Math.PI/2),e.scale(G/h,G/h),e.fillText(p.toString(),4*h,7*h),e.restore(),a?e.lineTo(m,l*9/16):e.lineTo(s*9/16,m)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=k;for(let p=F,y=0;p<W;p+=C,y++){const m=J+y*O+.5;a?e.moveTo(m,0):e.moveTo(0,m),p%N!=0&&(a?e.lineTo(m,l*1/4):e.lineTo(s*1/4,m))}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},ve={showIndicator:Boolean,valueNum:Number,scale:Number,ratio:Number,palette:Object,vertical:Boolean,start:Number,width:Number,height:Number,selectStart:Number,selectLength:Number},me=$({name:"CanvasRuler",props:ve,emits:["onAddLine","update:showIndicator","update:valueNum"],setup(e,{emit:t}){const n=H({canvasContext:null}),c=b(null);I(()=>{r(),a(),o()});const r=()=>{n.canvasContext=c.value&&c.value.getContext("2d")},a=()=>{if(c.value){const l=e.ratio;c.value.width=e.width*l,c.value.height=e.height*l;const d=n.canvasContext;d&&(d.font=`${12*l}px -apple-system,
                "Helvetica Neue", ".SFNSText-Regular",
                "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB",
                "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif`,d.lineWidth=1,d.textBaseline="middle")}},o=()=>{const l={scale:e.scale,width:e.width,height:e.height,palette:e.palette};e.vertical&&n.canvasContext?_(n.canvasContext,e.start,e.selectStart,e.selectLength,l):n.canvasContext&&(console.log(e.selectStart," props.selectStart"),_(n.canvasContext,e.start,e.selectStart,e.selectLength,l,!0))};return K(()=>e.start,()=>o()),K([()=>e.width,()=>e.height],()=>{a(),o()}),{handle:(l,d)=>{const i=(h,v,k)=>Math.round(v+h/k),u=e.vertical?l.offsetY:l.offsetX,f=i(u,e.start,e.scale);switch(d){case"click":t("onAddLine",f);break;case"enter":t("update:valueNum",f),t("update:showIndicator",!0);break;default:t("update:valueNum",f);break}},state:n,canvas:c,initCanvasRef:r}}});function ge(e,t,n,c,r,a){return R(),S("canvas",{ref:"canvas",class:"ruler",onClick:t[0]||(t[0]=o=>e.handle(o,"click")),onMouseenter:t[1]||(t[1]=o=>e.handle(o,"enter")),onMousemove:t[2]||(t[2]=o=>e.handle(o,"move")),onMouseleave:t[3]||(t[3]=o=>e.$emit("update:showIndicator",!1))},null,544)}var we=D(me,[["render",ge]]);const pe={scale:Number,ratio:Number,thick:Number,palette:Object,vertical:{type:Boolean,default:!0},width:{type:Number,default:200},height:{type:Number,default:200},start:{type:Number,default:0},lines:{type:Array,default:()=>[]},selectStart:{type:Number},selectLength:{type:Number},isShowReferLine:{type:Boolean}};const Ce=$({name:"RulerWrapper",components:{CanvasRuler:we,RulerLine:he},props:pe,setup(e){const t=b(!1),n=b(!1),c=b(0),r=g(()=>e.vertical?"v-container":"h-container"),a=g(()=>{const u={width:`calc(100% - ${e.thick}px)`,height:`${e.thick+1}px`,left:`${e.thick}px`},f={width:`${e.thick&&e.thick+1}px`,height:`calc(100% - ${e.thick}px)`,top:`${e.thick}px`};return e.vertical?f:u}),o=g(()=>{var v;const u=(c.value-e.start)*e.scale;let f="top",h="borderLeft";return f=e.vertical?"top":"left",h=e.vertical?"borderBottom":"borderLeft",{[f]:u+"px",[h]:`1px solid ${(v=e.palette)==null?void 0:v.lineColor}`}}),s=u=>{e.lines.push(u)},l=()=>{t.value=!0},d=(u,f)=>{t.value=!1;const h=u-e.start,v=(e.vertical?e.height:e.width)/e.scale;h<0||h>v?i(f):e.lines[f]=u},i=u=>{e.lines.splice(u,1)};return{isDraggingLine:t,showIndicator:n,valueNum:c,rwClassName:r,rwStyle:a,indicatorStyle:o,handleNewLine:s,handleLineDown:l,handleLineRelease:d,handleLineRemove:i}}}),ye={class:"lines"},be={class:"value"};function Re(e,t,n,c,r,a){const o=M("CanvasRuler"),s=M("RulerLine");return R(),S("div",{class:q(e.rwClassName),style:L(e.rwStyle)},[B(o,{vertical:e.vertical,scale:e.scale,width:e.width,height:e.height,start:e.start,ratio:e.ratio,"select-start":e.selectStart,"select-length":e.selectLength,palette:e.palette,valueNum:e.valueNum,"onUpdate:valueNum":t[0]||(t[0]=l=>e.valueNum=l),showIndicator:e.showIndicator,"onUpdate:showIndicator":t[1]||(t[1]=l=>e.showIndicator=l),onOnAddLine:e.handleNewLine},null,8,["vertical","scale","width","height","start","ratio","select-start","select-length","palette","valueNum","showIndicator","onOnAddLine"]),T(w("div",ye,[(R(!0),S(U,null,oe(e.lines,(l,d)=>(R(),le(s,{key:l+d,index:d,value:l>>0,scale:e.scale,start:e.start,thick:e.thick,palette:e.palette,vertical:e.vertical,"is-show-refer-line":e.isShowReferLine,onOnRemove:e.handleLineRemove,onOnMouseDown:e.handleLineDown,onOnRelease:e.handleLineRelease},null,8,["index","value","scale","start","thick","palette","vertical","is-show-refer-line","onOnRemove","onOnMouseDown","onOnRelease"]))),128))],512),[[P,e.isShowReferLine]]),T(w("div",{class:"indicator",style:L(e.indicatorStyle)},[w("div",be,j(e.valueNum),1)],4),[[P,e.showIndicator]])],6)}var Se=D(Ce,[["render",Re],["__scopeId","data-v-6668e137"]]);const ke={scale:{type:Number,default:1},ratio:{type:Number,default:1},thick:{type:Number,default:16},palette:Object,startX:{type:Number},startY:{type:Number,default:0},width:{type:Number,default:200},height:{type:Number,default:200},shadow:Object,lines:{type:Object,default:()=>({h:[],v:[]})},cornerActive:{type:Boolean,default:!1},isShowReferLine:{type:Boolean,default:!0}};const Ne=$({name:"SketchRule",components:{RulerWrapper:Se},props:ke,emits:["onCornerClick","handleLine"],setup(e,{emit:t}){const n=g(()=>{function o(l,d){return Object.keys(l).forEach(i=>{if(i&&l.hasOwnProperty(i)){if(typeof d.key=="object")console.log(i,"keykeykey"),l[i]=o(l[i],d[i]);else if(d.hasOwnProperty(i)){debugger;l[i]=d[i],console.log(l)}}}),l}const s=o({bgColor:"rgba(225,225,225, 0)",longfgColor:"#BABBBC",shortfgColor:"#C8CDD0",fontColor:"#7D8694",shadowColor:"#E8E8E8",lineColor:"#EB5648",borderColor:"#DADADC",cornerActiveColor:"rgb(235, 86, 72, 0.6)",menu:{bgColor:"#fff",dividerColor:"#DBDBDB",listItem:{textColor:"#415058",hoverTextColor:"#298DF8",disabledTextColor:"rgba(65, 80, 88, 0.4)",bgColor:"#fff",hoverBgColor:"#F2F2F2"}}},e.palette||{});return console.log(s,"6666"),s}),c=g(()=>e.cornerActive?" active":""),r=g(()=>({backgroundColor:n.value.bgColor,width:e.thick+"px",height:e.thick+"px",borderRight:`1px solid ${n.value.borderColor}`,borderBottom:`1px solid ${n.value.borderColor}`}));return{paletteCpu:n,cornerActiveClass:c,cornerStyle:r,onCornerClick:o=>{t("onCornerClick",o)}}}}),Le={id:"mb-ruler",class:"style-ruler mb-ruler"};function $e(e,t,n,c,r,a){const o=M("RulerWrapper");return R(),S("div",Le,[B(o,{vertical:!1,width:e.width,height:e.thick,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startX,lines:e.lines.h,"select-start":e.shadow.x,"select-length":e.shadow.width,scale:e.scale,palette:e.paletteCpu},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette"]),B(o,{vertical:!0,width:e.thick,height:e.height,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startY,lines:e.lines.v,"select-start":e.shadow.y,"select-length":e.shadow.height,scale:e.scale,palette:e.paletteCpu},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette"]),w("a",{class:q(["corner",e.cornerActiveClass]),style:L(e.cornerStyle),onClick:t[0]||(t[0]=(...s)=>e.onCornerClick&&e.onCornerClick(...s))},null,6)])}var A=D(Ne,[["render",$e]]);A.install=e=>{e.component(A.name,A)};const Q=200,Z=200,Be=$({components:{SketchRule:A},setup(){const e=b(null),t=b(null),n=H({scale:1,startX:0,startY:0,lines:{h:[0,200],v:[0,200]},thick:20,isShowRuler:!0,isShowReferLine:!0}),c=g(()=>({x:0,y:0,width:Q,height:Z})),r=g(()=>({width:Q,height:Z,transform:`scale(${n.scale})`}));I(()=>{e.value.scrollLeft=t.value.getBoundingClientRect().width/2-300});const a=()=>{const s=document.querySelector("#screens").getBoundingClientRect(),l=document.querySelector("#canvas").getBoundingClientRect(),d=(s.left+n.thick-l.left)/n.scale,i=(s.top+n.thick-l.top)/n.scale;n.startX=d,n.startY=i};return{screensRef:e,containerRef:t,state:n,shadow:c,canvasStyle:r,handleWheel:s=>{if(s.ctrlKey||s.metaKey){s.preventDefault();const l=parseFloat(Math.max(.2,n.scale-s.deltaY/500).toFixed(2));n.scale=l}ae(()=>{a()})},handleScroll:a}}}),De={class:"wrapper"},Oe={ref:"containerRef",class:"screen-container"};function Me(e,t,n,c,r,a){const o=M("SketchRule");return R(),S("div",De,[B(o,{thick:e.state.thick,scale:e.state.scale,width:780,height:480,"start-x":e.state.startX,"start-y":e.state.startY,shadow:e.shadow,"corner-active":!0,lines:e.state.lines},null,8,["thick","scale","start-x","start-y","shadow","lines"]),w("div",{id:"screens",ref:"screensRef",onWheel:t[0]||(t[0]=(...s)=>e.handleWheel&&e.handleWheel(...s)),onScroll:t[1]||(t[1]=(...s)=>e.handleScroll&&e.handleScroll(...s))},[w("div",Oe,[w("div",{id:"canvas",style:L(e.canvasStyle)},null,4)],512)],544)])}var Ae=D(Be,[["render",Me]]);const Ie=w("span",null,"2021/10/21",-1),Te={setup(e){return(t,n)=>(R(),S(U,null,[Ie,B(Ae)],64))}},Pe=re(Te);Pe.mount("#app");
