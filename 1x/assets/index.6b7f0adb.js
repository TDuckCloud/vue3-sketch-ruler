var te=Object.defineProperty;var Y=Object.getOwnPropertySymbols;var ne=Object.prototype.hasOwnProperty,oe=Object.prototype.propertyIsEnumerable;var j=(e,t,n)=>t in e?te(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,X=(e,t)=>{for(var n in t||(t={}))ne.call(t,n)&&j(e,n,t[n]);if(Y)for(var n of Y(t))oe.call(t,n)&&j(e,n,t[n]);return e};import{d as $,r as b,o as I,c as f,w as T,v as P,a as k,b as g,t as z,n as L,e as R,f as H,g as K,h as M,i as B,F as q,j as ae,k as U,l as le,m as G,p as se,q as re}from"./vendor.dcce5718.js";const ie=function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const l of document.querySelectorAll('link[rel="modulepreload"]'))s(l);new MutationObserver(l=>{for(const a of l)if(a.type==="childList")for(const o of a.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&s(o)}).observe(document,{childList:!0,subtree:!0});function n(l){const a={};return l.integrity&&(a.integrity=l.integrity),l.referrerpolicy&&(a.referrerPolicy=l.referrerpolicy),l.crossorigin==="use-credentials"?a.credentials="include":l.crossorigin==="anonymous"?a.credentials="omit":a.credentials="same-origin",a}function s(l){if(l.ep)return;l.ep=!0;const a=n(l);fetch(l.href,a)}};ie();const ce={scale:Number,thick:Number,palette:Object,index:Number,start:Number,vertical:Boolean,value:Number,isShowReferLine:Boolean};var D=(e,t)=>{for(const[n,s]of t)e[n]=s;return e};const ue=$({name:"LineRuler",props:ce,emits:["onMouseDown","onRelease","onRemove"],setup(e,{emit:t}){const n=b(0),s=b(!0);I(()=>{n.value=e.value});const l=u=>{s.value=u>=0},a=f(()=>{const u=(n.value-e.start)*e.scale;l(u);const c=u+"px";return e.vertical?{top:c}:{left:c}}),o=f(()=>{var d;const u=`1px solid ${(d=e.palette)==null?void 0:d.lineColor}`,c=e.vertical?{borderTop:u}:{borderLeft:u},h=e.isShowReferLine?e.vertical?"ns-resize":"ew-resize":"none";return X({cursor:h},c)}),i=f(()=>e.vertical?{left:e.thick+"px"}:{top:e.thick+"px"});return{startValue:n,showLine:s,offset:a,borderCursor:o,actionStyle:i,handleDown:u=>{const c=e.vertical?u.clientY:u.clientX,h=n.value;t("onMouseDown");const d=S=>{const p=e.vertical?S.clientY:S.clientX,O=Math.round(h+(p-c)/e.scale);n.value=O},m=()=>{t("onRelease",n.value,e.index),document.removeEventListener("mousemove",d),document.removeEventListener("mouseup",m)};document.addEventListener("mousemove",d),document.addEventListener("mouseup",m)},handleRemove:()=>{t("onRemove",e.index)}}}}),de={class:"value"};function he(e,t,n,s,l,a){return T((R(),k("div",{class:"line",style:L([e.offset,e.borderCursor]),onMousedown:t[1]||(t[1]=(...o)=>e.handleDown&&e.handleDown(...o))},[g("div",{class:"action",style:L(e.actionStyle)},[g("span",{class:"del",onClick:t[0]||(t[0]=(...o)=>e.handleRemove&&e.handleRemove(...o))},"\xD7"),g("span",de,z(e.startValue),1)],4)],36)),[[P,e.showLine]])}var ve=D(ue,[["render",he],["__scopeId","data-v-069c473f"]]);const fe=e=>e<=.25?40:e<=.5?20:e<=1?10:e<=2?5:e<=4?2:1,_=.83,Q=(e,t,n,s,l,a)=>{const{scale:o,width:i,height:r,palette:v}=l,{bgColor:u,fontColor:c,shadowColor:h,ratio:d,longfgColor:m,shortfgColor:S}=v;if(e.scale(d,d),e.clearRect(0,0,i,r),e.fillStyle=u,e.fillRect(0,0,i,r),s){const C=(n-t)*o,y=s*o;e.fillStyle=h,a?e.fillRect(C,0,y,r*3/8):e.fillRect(0,C,i*3/8,y)}const p=fe(o),O=p*o,N=p*10,F=N*o,V=Math.floor(t/p)*p,W=Math.floor(t/N)*N,x=(V-t)/p*O,ee=(W-t)/N*F,E=t+Math.ceil(a?i:r/o);e.beginPath(),e.fillStyle=c,e.strokeStyle=m;for(let C=W,y=0;C<E;C+=N,y++){const w=ee+y*F+.5;e.moveTo(w,0),e.save(),a?e.translate(w,r*.4):e.translate(i*.4,w),a||e.rotate(-Math.PI/2),e.scale(_/d,_/d),e.fillText(C.toString(),4*d,7*d),e.restore(),a?e.lineTo(w,r*9/16):e.lineTo(i*9/16,w)}e.stroke(),e.closePath(),e.beginPath(),e.strokeStyle=S;for(let C=V,y=0;C<E;C+=p,y++){const w=x+y*O+.5;a?e.moveTo(w,0):e.moveTo(0,w),C%N!=0&&(a?e.lineTo(w,r*1/4):e.lineTo(i*1/4,w))}e.stroke(),e.closePath(),e.setTransform(1,0,0,1,0,0)},me={showIndicator:Boolean,valueNum:Number,scale:Number,ratio:Number,palette:Object,vertical:Boolean,start:Number,width:Number,height:Number,selectStart:Number,selectLength:Number},we=$({name:"CanvasRuler",props:me,emits:["onAddLine","update:showIndicator","update:valueNum"],setup(e,{emit:t}){const n=H({canvasContext:null}),s=b(null);I(()=>{l(),a(),o()});const l=()=>{n.canvasContext=s.value&&s.value.getContext("2d")},a=()=>{if(s.value){const r=e.ratio;s.value.width=e.width*r,s.value.height=e.height*r;const v=n.canvasContext;v&&(v.font=`${12*r}px -apple-system,
                "Helvetica Neue", ".SFNSText-Regular",
                "SF UI Text", Arial, "PingFang SC", "Hiragino Sans GB",
                "Microsoft YaHei", "WenQuanYi Zen Hei", sans-serif`,v.lineWidth=1,v.textBaseline="middle")}},o=()=>{const r={scale:e.scale,width:e.width,height:e.height,palette:e.palette};e.vertical&&n.canvasContext?Q(n.canvasContext,e.start,e.selectStart,e.selectLength,r):n.canvasContext&&(console.log(e.selectStart," props.selectStart"),Q(n.canvasContext,e.start,e.selectStart,e.selectLength,r,!0))};return K(()=>e.start,()=>o()),K([()=>e.width,()=>e.height],()=>{a(),o()}),{handle:(r,v)=>{const u=(d,m,S)=>Math.round(m+d/S),c=e.vertical?r.offsetY:r.offsetX,h=u(c,e.start,e.scale);switch(v){case"click":t("onAddLine",h);break;case"enter":t("update:valueNum",h),t("update:showIndicator",!0);break;default:t("update:valueNum",h);break}},state:n,canvas:s,initCanvasRef:l}}});function ge(e,t,n,s,l,a){return R(),k("canvas",{ref:"canvas",class:"ruler",onClick:t[0]||(t[0]=o=>e.handle(o,"click")),onMouseenter:t[1]||(t[1]=o=>e.handle(o,"enter")),onMousemove:t[2]||(t[2]=o=>e.handle(o,"move")),onMouseleave:t[3]||(t[3]=o=>e.$emit("update:showIndicator",!1))},null,544)}var Ce=D(we,[["render",ge]]);const pe={scale:Number,ratio:Number,thick:Number,palette:Object,vertical:{type:Boolean,default:!0},width:{type:Number,default:200},height:{type:Number,default:200},start:{type:Number,default:0},lines:{type:Array,default:()=>[]},selectStart:{type:Number},selectLength:{type:Number},isShowReferLine:{type:Boolean}};const ye=$({name:"RulerWrapper",components:{CanvasRuler:Ce,RulerLine:ve},props:pe,setup(e){const t=b(!1),n=b(!1),s=b(0),l=f(()=>e.vertical?"v-container":"h-container"),a=f(()=>{const c={width:`calc(100% - ${e.thick}px)`,height:`${e.thick+1}px`,left:`${e.thick}px`},h={width:`${e.thick&&e.thick+1}px`,height:`calc(100% - ${e.thick}px)`,top:`${e.thick}px`};return e.vertical?h:c}),o=f(()=>{var m;const c=(s.value-e.start)*e.scale;let h="top",d="borderLeft";return h=e.vertical?"top":"left",d=e.vertical?"borderBottom":"borderLeft",{[h]:c+"px",[d]:`1px solid ${(m=e.palette)==null?void 0:m.lineColor}`}}),i=c=>{e.lines.push(c)},r=()=>{t.value=!0},v=(c,h)=>{t.value=!1;const d=c-e.start,m=(e.vertical?e.height:e.width)/e.scale;d<0||d>m?u(h):e.lines[h]=c},u=c=>{e.lines.splice(c,1)};return{isDraggingLine:t,showIndicator:n,valueNum:s,rwClassName:l,rwStyle:a,indicatorStyle:o,handleNewLine:i,handleLineDown:r,handleLineRelease:v,handleLineRemove:u}}}),be={class:"lines"},Re={class:"value"};function ke(e,t,n,s,l,a){const o=M("CanvasRuler"),i=M("RulerLine");return R(),k("div",{class:U(e.rwClassName),style:L(e.rwStyle)},[B(o,{vertical:e.vertical,scale:e.scale,width:e.width,height:e.height,start:e.start,ratio:e.ratio,"select-start":e.selectStart,"select-length":e.selectLength,palette:e.palette,valueNum:e.valueNum,"onUpdate:valueNum":t[0]||(t[0]=r=>e.valueNum=r),showIndicator:e.showIndicator,"onUpdate:showIndicator":t[1]||(t[1]=r=>e.showIndicator=r),onOnAddLine:e.handleNewLine},null,8,["vertical","scale","width","height","start","ratio","select-start","select-length","palette","valueNum","showIndicator","onOnAddLine"]),T(g("div",be,[(R(!0),k(q,null,ae(e.lines,(r,v)=>(R(),le(i,{key:r+v,index:v,value:r>>0,scale:e.scale,start:e.start,thick:e.thick,palette:e.palette,vertical:e.vertical,"is-show-refer-line":e.isShowReferLine,onOnRemove:e.handleLineRemove,onOnMouseDown:e.handleLineDown,onOnRelease:e.handleLineRelease},null,8,["index","value","scale","start","thick","palette","vertical","is-show-refer-line","onOnRemove","onOnMouseDown","onOnRelease"]))),128))],512),[[P,e.isShowReferLine]]),T(g("div",{class:"indicator",style:L(e.indicatorStyle)},[g("div",Re,z(e.valueNum),1)],4),[[P,e.showIndicator]])],6)}var Se=D(ye,[["render",ke],["__scopeId","data-v-6668e137"]]);const Ne={scale:{type:Number,default:1},ratio:{type:Number,default:1},thick:{type:Number,default:16},palette:Object,startX:{type:Number},startY:{type:Number,default:0},width:{type:Number,default:200},height:{type:Number,default:200},shadow:Object,lines:{type:Object,default:()=>({h:[],v:[]})},cornerActive:{type:Boolean,default:!1},isShowReferLine:{type:Boolean,default:!0}};const Le=$({name:"SketchRule",components:{RulerWrapper:Se},props:Ne,emits:["onCornerClick","handleLine"],setup(e,{emit:t}){const n=f(()=>G({x:0,y:0,width:200,height:200},e.shadow||{})),s=f(()=>G({bgColor:"rgba(225,225,225, 0)",longfgColor:"#BABBBC",shortfgColor:"#C8CDD0",fontColor:"#7D8694",shadowColor:"#E8E8E8",lineColor:"#EB5648",borderColor:"#DADADC",cornerActiveColor:"rgb(235, 86, 72, 0.6)",menu:{bgColor:"#fff",dividerColor:"#DBDBDB",listItem:{textColor:"#415058",hoverTextColor:"#298DF8",disabledTextColor:"rgba(65, 80, 88, 0.4)",bgColor:"#fff",hoverBgColor:"#F2F2F2"}}},e.palette||{})),l=f(()=>e.cornerActive?" active":""),a=f(()=>({backgroundColor:s.value.bgColor,width:e.thick+"px",height:e.thick+"px",borderRight:`1px solid ${s.value.borderColor}`,borderBottom:`1px solid ${s.value.borderColor}`}));return{paletteCpu:s,shadowCpu:n,cornerActiveClass:l,cornerStyle:a,onCornerClick:i=>{t("onCornerClick",i)}}}}),$e={id:"mb-ruler",class:"style-ruler mb-ruler"};function Be(e,t,n,s,l,a){const o=M("RulerWrapper");return R(),k("div",$e,[B(o,{vertical:!1,width:e.width,height:e.thick,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startX,lines:e.lines.h,"select-start":e.shadowCpu.x,"select-length":e.shadowCpu.width,scale:e.scale,palette:e.paletteCpu},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette"]),B(o,{vertical:!0,width:e.thick,height:e.height,"is-show-refer-line":e.isShowReferLine,thick:e.thick,ratio:e.ratio,start:e.startY,lines:e.lines.v,"select-start":e.shadowCpu.y,"select-length":e.shadowCpu.height,scale:e.scale,palette:e.paletteCpu},null,8,["width","height","is-show-refer-line","thick","ratio","start","lines","select-start","select-length","scale","palette"]),g("a",{class:U(["corner",e.cornerActiveClass]),style:L(e.cornerStyle),onClick:t[0]||(t[0]=(...i)=>e.onCornerClick&&e.onCornerClick(...i))},null,6)])}var A=D(Le,[["render",Be]]);A.install=e=>{e.component(A.name,A)};const Z=200,J=200,De=$({components:{SketchRule:A},setup(){const e=b(null),t=b(null),n=H({scale:1,startX:0,startY:0,lines:{h:[0,200],v:[0,200]},thick:20,isShowRuler:!0,isShowReferLine:!0}),s=f(()=>({x:0,y:0,width:Z,height:J})),l=f(()=>({width:Z,height:J,transform:`scale(${n.scale})`}));I(()=>{e.value.scrollLeft=t.value.getBoundingClientRect().width/2-300});const a=()=>{const i=document.querySelector("#screens").getBoundingClientRect(),r=document.querySelector("#canvas").getBoundingClientRect(),v=(i.left+n.thick-r.left)/n.scale,u=(i.top+n.thick-r.top)/n.scale;n.startX=v,n.startY=u};return{screensRef:e,containerRef:t,state:n,shadow:s,canvasStyle:l,handleWheel:i=>{if(i.ctrlKey||i.metaKey){i.preventDefault();const r=parseFloat(Math.max(.2,n.scale-i.deltaY/500).toFixed(2));n.scale=r}se(()=>{a()})},handleScroll:a}}}),Oe={class:"wrapper"},Me={ref:"containerRef",class:"screen-container"};function Ae(e,t,n,s,l,a){const o=M("SketchRule");return R(),k("div",Oe,[B(o,{thick:e.state.thick,scale:e.state.scale,width:780,height:480,"start-x":e.state.startX,"start-y":e.state.startY,shadow:e.shadow,"corner-active":!0,lines:e.state.lines},null,8,["thick","scale","start-x","start-y","shadow","lines"]),g("div",{id:"screens",ref:"screensRef",onWheel:t[0]||(t[0]=(...i)=>e.handleWheel&&e.handleWheel(...i)),onScroll:t[1]||(t[1]=(...i)=>e.handleScroll&&e.handleScroll(...i))},[g("div",Me,[g("div",{id:"canvas",style:L(e.canvasStyle)},null,4)],512)],544)])}var Ie=D(De,[["render",Ae]]);const Te=g("span",null,"2021/10/21",-1),Pe={setup(e){return(t,n)=>(R(),k(q,null,[Te,B(Ie)],64))}},Fe=re(Pe);Fe.mount("#app");
